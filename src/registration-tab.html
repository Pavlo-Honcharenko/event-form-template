<html>
	<head>


		<script src="//www.google.com/jsapi"></script>
		<script>
			window.parent.maeExportApis_();
		</script>

		<link
			rel="stylesheet"
			href="https://ssl.gstatic.com/docs/script/css/add-ons1.css"
		/>

		<style>
			select {
				text-align-last: left;
				padding-left: 8px;
				-webkit-appearance: none;
				-moz-appearance: none;
				appearance: none;
			}

			#ec_mw {
				padding: 5px 10px 5px 5px;
				z-index: 1000;
				overflow: hidden;
				display: flex;
				justify-content: center;
				align-items: center;
				min-height: 400px;
				vertical-align: top;
			}

			#ec_status_div {
				display: none;
				background-color: #ffff99;
				padding: 2px 2px 2px 0px;
				width: 90%;
			}

			#ec_status_content {
				border: 0px solid;

				min-height: 15px;
				padding: 8px 8px 8px 5px;
			}

			#ec_tabs {
				width: 100%;
			}

			#ec_tab_body {
				overflow: hidden;
			}

			.tab {
				overflow: hidden;
			}

			.tab span {
				background-color: inherit;
				float: left;
				border-width: 1px;
				border-style: solid;
				border-top-left-radius: 8px;
				border-top-right-radius: 8px;
				cursor: pointer;
				transition: 0.3s;
				width: 175px;
				height: 35px;
				line-height: 35px;
				text-align: center;
			}

			.tab span:hover {
				background-color: #c0c0c0;
			}

			.tab span.active {
				background-color: #d3d3d3;
			}

			.tabcontent {
				display: none;
				padding: 6px 12px;
				border: 1px solid #ccc;
				min-height: 400px;
				max-height: 400px;
			}

			#ec_field_label {
				font-size: 10px;
				color: grey;
			}

			#online_event_instructions_container {
				height: 100px;
			}

			#additional_event_info_container {
				height: 100px;
			}

			#registrations_table {
				font-family: Arial, Helvetica, sans-serif;
				border-collapse: collapse;
				width: 100%;
			}

			#registrations_table td,
			#registrations_table th {
				border: 1px solid #ddd;
				padding: 8px;
			}

			#registrations_table tr:nth-child(3n + 2) {
				background-color: #f2f2f2;
			}

			#registrations_table tr:hover {
				background-color: #ddd;
			}

			#registrations_table th,
			#registrations_table a {
				padding-top: 12px;
				padding-bottom: 12px;
				text-align: left;
				background-color: #04aa6d;
				color: white;
			}

			.multi_options_btn {
				.button: active;
				cursor: pointer;
			}

			.multi_options_btn:hover,
			.multi_options_btn:focus {
				background-color: #2980b9;
			}

			.multi_options_button {
				position: relative;
				display: inline-block;
			}

			.multi_options_button-content {
				display: none;
				position: absolute;
				background-color: #f1f1f1;
				min-width: 160px;
				box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
				font-size: 11px;
				text-align: left;
				z-index: 1;
			}

			.multi_options_button-content a {
				color: black;
				padding: 12px 16px;
				text-decoration: none;
				display: block;
			}

			.multi_options_button-content a:hover {
				background-color: #ddd;
			}

			.show {
				display: block;
			}

			.modal {
				display: none;
				flex-direction: column;
				justify-content: center;
				gap: 0.4rem;
				width: 650px;
				padding: 1.3rem;
				min-height: 200px;
				max-height: 300px;
				position: absolute;
				left: 13%;
				margin: auto;
				top: 20%;
				background-color: white;
				border: 1px solid #ddd;
				border-radius: 15px;
				z-index: 1002;
				overflow-y: auto;
			}

			.overlay {
				display: none;
				position: fixed;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				backdrop-filter: blur(3px);
				z-index: 1001;
			}

			.editable_field {
				position: relative;
				display: inline-block;
			}

			.editable_field:hover {
				border-style: dashed;
				cursor: pointer;
			}

			.editable_field .tooltiptext {
				visibility: hidden;
				width: 120px;
				background-color: black;
				color: #fff;
				text-align: center;
				border-radius: 6px;
				padding: 5px 0;
				position: absolute;
				z-index: 1;
				bottom: 150%;
				left: 50%;
				margin-left: -60px;
				font-family: Arial, Helvetica, sans-serif;
				font-size: 16px;
			}

			.editable_field .tooltiptext::after {
				content: "";
				position: absolute;
				top: 100%;
				left: 50%;
				margin-left: -5px;
				border-width: 5px;
				border-style: solid;
				border-color: black transparent transparent transparent;
			}

			.editable_field:hover .tooltiptext {
				visibility: visible;
			}

			.overview_grid {
				border: 1px solid gray;
				border-collapse: collapse;
				padding: 20px;
				table-layout: fixed;
				text-align: center;
				height: 340px;
				text-align: center;
			}

			table.overview_grid td {
				border: 1px solid gray;
				border-collapse: collapse;
				width: 33%;
			}

			table.overview_grid tr {
				height: 50%;
			}

			.overview_content_grid {
				border-style: hidden;
				table-layout: fixed;
				text-align: center;
				height: 100%;
				wdith: 100%;
			}

			table.overview_content_grid td {
				border-style: hidden;
				text-align: center;
			}

			table.overview_content_grid tr {
				height: 33%;
			}

			.overview_label {
				font-weight: bold;
				vertical-align: top;
			}

			.overview_value {
				font-size: 20px;
				color: DodgerBlue;
				vertical-align: middle;
			}

			.overview_actions {
				font-size: 14px;
				vertical-align: bottom;
			}

			.last_refresh {
				boarder-style: solid;
				width: 100%;
				font-size: 11px;
				font-style: italic;
			}

			@import url(https://fonts.googleapis.com/css?family=Plus+Jakarta+Sans:regular,500,600,700&display=swap);

			@import url(https://fonts.googleapis.com/css?family=Roboto:regular,500&display=swap);

			@import url(https://fonts.googleapis.com/css?family=Inter:regular,500,600,700&display=swap);

			@import url(https://fonts.googleapis.com/css?family=Poppins:500,600,700&display=swap);

			@charset "UTF-8";

			.modal {
				border-radius: 9px;
				background: #fff;
				padding: 20px 30px;
				font-family: Plus Jakarta Sans;
			}

			.modal strong {
				font-family: Plus Jakarta Sans;
				font-size: 20px;
				font-style: normal;
				font-weight: 700;
				line-height: 32px;

				letter-spacing: 0.1px;
				color: #171725;
			}

			.modal hr {
				color: rgba(0, 0, 0, 0.14);
			}

			.modal label {
				font-family: Plus Jakarta Sans;
				font-size: 14px;
				font-style: normal;
				font-weight: 500;
				color: #1f2937;
				line-height: 22px;

				letter-spacing: 0.07px;
			}

			.modal #ec_field_label {
				margin-top: 2px;
				font-size: 14px;
			}

			.modal textarea {
				border-radius: 5px;
				border: 1px solid rgba(0, 0, 0, 0.1);
				width: 100%;
				margin: 6px 0;
				font-size: 16px;
			}

			.modal select {
				border-radius: 2px;
				border: 1px solid #d9d9d9;
				background:
					url(https://ssl.gstatic.com/ui/v1/disclosure/grey-disclosure-arrow-up-down.png)
						no-repeat calc(100% - 10px) center,
					-webkit-linear-gradient(top, #fff, #fff);
				font-family: Roboto;
				font-size: 16px;
				font-style: normal;
				font-weight: 400;
				line-height: 24px;
				color: rgba(0, 0, 0, 0.85);
				padding: 10px 12px;
				height: auto;
				border-radius: 5.268px;
				border: 1.317px solid #e5e5e5;
			}

			.modal #location,
			.modal #title {
				height: auto;
				min-height: 45px;
				border-radius: 5.268px;
				border: 1.317px solid #e5e5e5;
				padding: 10px 12px;
				font-family: Plus Jakarta Sans;
				font-size: 16px;
				font-style: normal;
				font-weight: 500;
				line-height: 24px;
				letter-spacing: 0.08px;
				margin-top: 2px;
			}

			.modal input.action {
				border-radius: 4px;
				background: #761b7b;
				display: -webkit-inline-box;
				display: -ms-inline-flexbox;
				display: inline-flex;
				height: 34px;
				padding: 12px 24px;
				-webkit-box-pack: center;
				-ms-flex-pack: center;
				justify-content: center;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				font-family: Plus Jakarta Sans;
				font-size: 14px;
				font-style: normal;
				font-weight: 600;
				line-height: 22px;
				letter-spacing: 0.07px;
				color: #fefefe;
				height: initial;
				width: initial;
				margin-top: 15px;
				cursor: pointer;
			}

			.modal input[type="button"].active {
				border-radius: 4px;
				background: rgba(0, 0, 0, 0.1);
				display: -webkit-inline-box;
				display: -ms-inline-flexbox;
				display: inline-flex;
				height: 34px;
				padding: 12px 24px;
				-webkit-box-pack: center;
				-ms-flex-pack: center;
				justify-content: center;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				color: #000000;
				font-family: Plus Jakarta Sans;
				font-size: 14px;
				font-style: normal;
				font-weight: 600;
				line-height: 22px;
				letter-spacing: 0.07px;
				height: initial;
				width: initial;
				margin-right: 8px;
				margin-top: 15px;
				cursor: pointer;
			}

			.modal #ec_field_label {
				margin-bottom: 10px;
			}

			.modal #event_theme {
				min-width: 300px;
			}

			.ql-toolbar.ql-snow {
				margin-top: 15px;
				border-radius: 5px 5px 0 0;
				border: 1px solid rgba(0, 0, 0, 0.14);
			}

			.ql-editor {
				border-radius: 0 0 5px 5px;
				border: 1px solid rgba(0, 0, 0, 0.14);
			}

			#start_time,
			#start_time_time,
			#end_time_time,
			#end_time {
				width: -webkit-fit-content;
				width: -moz-fit-content;
				width: fit-content;
				min-width: 23.25%;
				color: rgba(0, 0, 0, 0.85);
				font-family: Roboto;
				font-size: 14px;
				font-style: normal;
				font-weight: 400;
				padding: 10px 15px;
				border-radius: 2.644px;
				border: 1px solid #d9d9d9;
			}

			#start_time_error,
			#end_time_error {
				padding-top: 4px;
				font-family: Inter;
				font-size: 14px;
				font-style: normal;
				font-weight: 400;
				line-height: 20px;
				letter-spacing: 0.15px;
			}

			#ec_loading .ec_loading_wrapper {
				width: 100%;
				height: 100%;
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-pack: center;
				-ms-flex-pack: center;
				justify-content: center;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				-webkit-box-orient: vertical;
				-webkit-box-direction: normal;
				-ms-flex-direction: column;
				flex-direction: column;
				gap: 22px;
			}

			#ec_loading .ec_loading_wrapper .ec_loading_text {
				color: #761b7b;
				font-family: Plus Jakarta Sans;
				font-size: 24px;
				font-style: normal;
				font-weight: 600;
				line-height: 38px;
				letter-spacing: 0.12px;
			}

			#ec_loading .ec_loading_wrapper svg {
				display: inline-block;
				-webkit-animation: spindotts 2s infinite linear;
				animation: spindotts 2s infinite linear;
			}

			@-webkit-keyframes spindotts {
				from {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}

				to {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}

			@keyframes spindotts {
				from {
					-webkit-transform: rotate(0deg);
					transform: rotate(0deg);
				}

				to {
					-webkit-transform: rotate(360deg);
					transform: rotate(360deg);
				}
			}

			@media (min-width: 47.99875em) {
				.modal {
					overflow-x: hidden;
				}
			}
		</style>

		<link
			href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
			rel="stylesheet"
		/>

		<link
			rel="stylesheet"
			href="css/style.css"
		/>

		<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>

		<script>
			var quillOnlineEventInstr;
			var quillAddlEventInfo;

			let sessionTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
			let regFormURL;
			let currentRegSortBy;
			let formQuestions;
			let formQuestionIDs;

			let refreshOverviewTimeout;

			$(function () {
				init();
			});

			function init() {
				call_timeout = window.setInterval(populateReprocessDataTimeout, 300000);

				loadEventConsoleWindow();
			}

			function loadEventConsoleWindow() {
				$("#ec_tabs").hide();

				$("#ec_loading").show();
				google.script.run
					.withSuccessHandler(populateEventConsoleData)
					.withFailureHandler(populateEventConsoleDataError)
					.uiGetEventConsoleData();
			}

			function populateEventConsoleData(ecData) {
				window.clearInterval(call_timeout);

				$("#ec_loading").hide();

				if (!ecData || ecData.event_load_status == "2") {
					showError(
						"We are unable to access your event data. Please contact EventForm support."
					);
					return;
				}

				populateEventWebsiteHTML(
					ecData.event.event_state,
					ecData.eventWebsiteHTML
				);
				activateBanner(ecData.event.event_theme, ecData.eventThemes, true);

				if (ecData.event.event_state === "INACTIVE") {
					$("#review_and_publish").show();
					regFormURL = ecData.editableRegFormURL;
				} else {
					populateShareEvent(ecData.event, ecData.eventWebsiteURL);
					loadOverview(ecData);

					formQuestions = ecData.formQuestions;
					formQuestionIDs = ecData.formQuestionIDs;
					loadRegistrations(
						ecData.registrations,
						ecData.registrationFilter,
						ecData.registrationSortBy
					);
					loadRegButtonsBar(ecData.event);
					$("#ec_tabs").show();
				}

				loadFormFields(ecData);

				loadButtonsBar(ecData.event.event_state);

				document.getElementById("event_id").value = ecData.event.event_id;
				document.getElementById("event_id_for_settings").value =
					ecData.event.event_id;
				document.getElementById("event_website_url").value =
					ecData.eventWebsiteURL;
			}

			function refreshOverview() {
				window.clearInterval(refreshOverviewTimeout);

				google.script.run
					.withSuccessHandler(refreshOverviewSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiRefreshOverviewData();
			}

			function refreshOverviewSuccessCallback(ecData) {
				loadOverview(ecData);
			}

			function loadOverview(ecData) {
				let currentDate = new Date().getTime();
				let eventStartTime = new Date(
					ecData.event.start_time + "T" + ecData.event.start_time_time
				).getTime();

				document.getElementById("time_till_event_overview").innerHTML =
					getTimeTillEvent(ecData.event);

				let regBreakdown = getRegBreakdown(ecData.registrations);

				if (currentDate >= eventStartTime - 3600000) {
					document.getElementById("registered_attendees_label").innerHTML =
						"Checked In Attendees: ";
					document.getElementById("registered_attendees_overview").innerHTML =
						regBreakdown["checkedIn"] +
						" out of " +
						(regBreakdown["attending"] + regBreakdown["checkedIn"]);
					document.getElementById("registered_attendees_actions").innerHTML =
						'<a href="#" onclick="viewFilteredRegistrations(\'' +
						"CHECKED_IN" +
						"')\">" +
						"View" +
						"</a>";
				} else {
					document.getElementById("registered_attendees_overview").innerHTML =
						regBreakdown["attending"];
				}

				document.getElementById("awaiting_admin_approval_overview").innerHTML =
					regBreakdown["awaitingApproval"];
				document.getElementById("waitlisted_overview").innerHTML =
					regBreakdown["waitlisted"];

				let regWindownOverviewResponse = getRegWindowOverview(ecData.event);
				document.getElementById("days_till_reg_close_overview").innerHTML =
					regWindownOverviewResponse["regWindowOverview"];
				document.getElementById("days_till_reg_close_actions").innerHTML =
					regWindownOverviewResponse["regWindowActions"];

				document.getElementById("last_refresh_overview").innerHTML =
					"Last Updated: " + new Date().toLocaleTimeString();

				refreshOverviewTimeout = window.setInterval(refreshOverview, 300000);
			}

			function editEventCapacity() {
				openTab(null, "settings", "settings_tab");
				document
					.getElementById("max_registrants")
					.focus({ focusVisible: true });
			}

			function editRegistrationPeriod() {
				openTab(null, "settings", "settings_tab");
				document.getElementById("reg_start_time").focus({ focusVisible: true });
			}

			function editWaitlistSettings() {
				openTab(null, "settings", "settings_tab");
				document
					.getElementById("waitlist_enabled")
					.focus({ focusVisible: true });
			}

			function editEventWebsite() {
				openTab(null, "event_website", "event_website_tab");
			}

			function getRegWindowOverview(event) {
				let regWindowOverviewResponse = {};
				let regWindowOverview = "";
				let regWindowActions = "";

				let currentDate = new Date().getTime();
				let eventStartTime = new Date(
					event.start_time + "T" + event.start_time_time
				).getTime();
				let eventEndTime = new Date(
					event.end_time + "T" + event.end_time_time
				).getTime();

				let regStartTime = currentDate - 86400000;
				if (event.reg_start_time) {
					regStartTime = new Date(
						event.reg_start_time + "T" + event.reg_start_time_time
					).getTime();
				}

				let regEndTime = eventStartTime;
				if (event.reg_end_time) {
					regEndTime = new Date(
						event.reg_end_time + "T" + event.reg_end_time_time
					).getTime();
				}

				if (event["event_state"] === "CLOSED") {
					regWindowOverview = "Closed by Administrator";
					if (currentDate < eventEndTime) {
						regWindowActions =
							'<a href="#" onclick="openRegistration()">' +
							"Open Registration" +
							"</a>";
					}
				} else if (currentDate > regEndTime) {
					regWindowOverview = "Closed";
				} else if (currentDate < regStartTime) {
					regWindowOverview = "Opens in ";
					let ms = regStartTime - currentDate;
					let timeTillRegOpens = getTimeTill(ms);

					if (timeTillRegOpens.length === 0) {
						timeTillRegOpens = "Less Than a Minute";
					}

					regWindowOverview += timeTillRegOpens;
				} else {
					let ms = regEndTime - currentDate;
					let timeTillRegCloses = getTimeTill(ms);

					if (timeTillRegCloses.length === 0) {
						timeTillRegCloses = "Less Than a Minute";
					}

					regWindowOverview = timeTillRegCloses;
				}

				if (event["event_state"] !== "CLOSED" && currentDate < eventEndTime) {
					regWindowActions =
						'<a href="#" onclick="editRegistrationPeriod()">' +
						"Edit Reg. Period" +
						"</a>";
				}

				regWindowOverviewResponse = {
					regWindowOverview: regWindowOverview,
					regWindowActions: regWindowActions,
				};

				return regWindowOverviewResponse;
			}

			function getRegBreakdown(registrations) {
				let attending = 0;
				let awaitingApproval = 0;
				let waitlisted = 0;
				let checkedIn = 0;

				let regBreakdown = {
					attending: attending,
					awaitingApproval: awaitingApproval,
					waitlisted: waitlisted,
					checkedIn: checkedIn,
				};

				if (!registrations || registrations.length === 0) regBreakdown;

				for (let i = 0; i < registrations.length; i++) {
					let reg = registrations[i];

					if (reg["regStatus"] === "ATTENDING") {
						attending++;
					} else if (reg["regStatus"] === "UNPROCESSED") {
						awaitingApproval++;
					}
					if (reg["regStatus"] === "WAITLISTED") {
						waitlisted++;
					}
					if (reg["regStatus"] === "CHECKED_IN") {
						checkedIn++;
					}
				}

				regBreakdown = {
					attending: attending,
					awaitingApproval: awaitingApproval,
					waitlisted: waitlisted,
					checkedIn: checkedIn,
				};

				return regBreakdown;
			}

			function getTimeTillEvent(event) {
				let timeTillEvent = "";
				let currentDate = new Date().getTime();
				let eventStartTime = new Date(
					event.start_time + "T" + event.start_time_time
				).getTime();
				let eventEndTime = new Date(
					event.end_time + "T" + event.end_time_time
				).getTime();
				let ms = eventStartTime - currentDate;

				if (currentDate >= eventEndTime) {
					timeTillEvent = "Event Finished";
				} else if (
					currentDate >= eventStartTime &&
					currentDate < eventEndTime
				) {
					timeTillEvent = "Happening Now";
				} else {
					timeTillEvent = getTimeTill(ms);

					if (timeTillEvent.length === 0) {
						timeTillEvent = "Starting Now";
					}
				}

				return timeTillEvent;
			}

			function getTimeTill(ms) {
				let timeTill;

				if (ms < 86400000) {
					timeTill = getHoursTillEvent(ms);
					let minutesStr = getMinutesTillEvent(ms);
					if (timeTill.length > 0 && minutesStr.length > 0) {
						timeTill += " and ";
					}
					if (minutesStr.length > 0) {
						timeTill += minutesStr;
					}
				} else {
					timeTill = getDaysTillEvent(ms);
					let hoursStr = getHoursTillEvent(ms);
					if (timeTill.length > 0 && hoursStr.length > 0) {
						timeTill += " and ";
					}
					if (hoursStr.length > 0) {
						timeTill += hoursStr;
					}
				}

				return timeTill;
			}

			function getDaysTillEvent(ms) {
				let days = Math.floor(ms / 1000 / 60 / 60 / 24);

				if (days === 0) {
					return "";
				} else if (days === 1) {
					return days + " Day";
				}

				return days + " Days";
			}

			function getHoursTillEvent(ms) {
				let hours = Math.floor((ms / 1000 / 60 / 60) % 24);

				if (hours === 0) {
					return "";
				} else if (hours === 1) {
					return hours + " Hour";
				}

				return hours + " Hours";
			}

			function getMinutesTillEvent(ms) {
				let minutes = Math.floor((ms / 1000 / 60) % 60);

				if (minutes === 0) {
					return "";
				} else if (minutes === 1) {
					return minutes + " Minute";
				}

				return minutes + " Minutes";
			}

			function activateBanner(currentTheme, eventThemes, loadThemes) {
				let bannerDiv = document.getElementById("bannerImage");
				bannerDiv.className = "editable_field";
				bannerDiv.addEventListener("click", function () {
					editTheme();
				});

				let bannerDivHTML = bannerDiv.innerHTML;
				bannerDiv.innerHTML =
					bannerDivHTML +
					'<span class="tooltiptext">' +
					"Click to edit" +
					"</span></div>";

				if (loadThemes) {
					let themeSelectElement = document.getElementById("event_theme");
					for (let theme in eventThemes) {
						let themeOption = new Option();
						themeOption.value = eventThemes[theme];
						themeOption.text = theme;
						if (eventThemes[theme] === currentTheme) {
							themeOption.selected = true;
						}
						themeSelectElement.options.add(themeOption);
					}
				}
			}

			function editTheme() {
				document.getElementById("edit_modal_event_theme").style =
					"display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer(elementId);
					});
			}

			function populateEventWebsiteHTML(eventState, eventWebsiteHTML) {
				if (eventState === "INACTIVE") {
					$("#themed_event_view").html(eventWebsiteHTML);
				} else {
					$("#themed_event_view_ed").html(eventWebsiteHTML);
				}
			}

			function loadFormFields(ecData) {
				loadFormFieldsFromObj(ecData.event);

				let onlineEventInstr = document.getElementById(
					"online_event_instructions"
				);
				if (onlineEventInstr && onlineEventInstr.value.length > 0) {
					quillOnlineEventInstr.clipboard.dangerouslyPasteHTML(
						onlineEventInstr.value
					);
				}

				let addlEventInfo = document.getElementById("additional_event_info");
				if (addlEventInfo && addlEventInfo.value.length > 0) {
					quillAddlEventInfo.clipboard.dangerouslyPasteHTML(
						addlEventInfo.value
					);
				}

				if (ecData.event.start_time && ecData.event.start_time.length > 0) {
					let startDateTime = new Date(
						ecData.event.start_time + "T" + ecData.event.start_time_time
					);
					let endDateTime = new Date(
						ecData.event.end_time + "T" + ecData.event.end_time_time
					);
					setEventDateTimeDiff(startDateTime, endDateTime);
				}

				displayLocation();
				enableWaitlist();
			}

			function populateShareEvent(event, event_website_url) {
				let shareEventText = event_website_url;
				if (event.website_passcode) {
					shareEventText += "\n\nPasscode: " + event.website_passcode;
				}
				document.getElementById("share_event_instr").value = shareEventText;
			}

			function editEventField(field) {
				if (
					field === "eventStartDate" ||
					field === "eventEndDate" ||
					field === "eventStartTime" ||
					field === "eventEndTime" ||
					field === "eventStartDateAndTime" ||
					field === "eventEndDateAndTime" ||
					field === "eventTimezone"
				) {
					field = "eventWhen";
				}

				if (
					field === "eventLocationType" ||
					field === "eventLocation" ||
					field === "eventOnlineInstructions"
				) {
					field = "eventWhere";
				}

				let elementId = "edit_modal_" + field;
				document.getElementById(elementId).style = "display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer(elementId);
					});
			}

			function loadFormFieldsFromObj(obj) {
				if (!obj) return;
				for (const objKey in obj) {
					let objVal = obj[objKey];

					if (typeof objVal === "object") {
						loadFormFieldsFromObj(objVal);
					} else {
						setFormField(objKey, objVal);
					}
				}
			}

			function setFormField(fieldId, fieldVal) {
				let formField = document.getElementById(fieldId);
				if (formField) {
					if (formField.type === "checkbox" && fieldVal === "on") {
						formField.checked = true;
					} else {
						formField.value = fieldVal;
					}
				}
			}

			function previewEvent() {
				window.open(document.getElementById("event_website_url").value);
			}

			let fieldErrorDivs = new Array();

			function loadFieldErrors(fieldErrors) {
				if (!fieldErrors) return;

				for (const fieldName in fieldErrors) {
					let fieldError = fieldErrors[fieldName];
					let fieldErrorDiv = document.getElementById(fieldName);
					if (fieldErrorDiv) {
						fieldErrorDiv.innerHTML =
							'<font color="red" size="2">' + fieldError + "</font>";
						fieldErrorDiv.style = "display:block;";
						fieldErrorDivs.push(fieldErrorDiv);
					}
				}
			}

			function clearFieldErrors() {
				if (!fieldErrorDivs || fieldErrorDivs.length === 0) return;

				for (let i = 0; i < fieldErrorDivs.length; i++) {
					fieldErrorDivs[i].innerHTML = "";
					fieldErrorDivs[i].style = "display:none;";
				}

				fieldErrorDivs = [];
			}

			function saveEvent(doNotRefresh) {
				clearFieldErrors();
				if (validateEventInput()) {
					buttonsController(true);
					populateFieldsFromRTE();
					if (doNotRefresh) {
						document.getElementById("doNotRefresh").value = "1";
					} else {
						document.getElementById("doNotRefresh").value = "0";
					}
					google.script.run
						.withSuccessHandler(saveEventSuccessCallback)
						.withFailureHandler(saveEventFailureCallback)
						.uiSaveEvent($("#event_config_form")[0]);
				}
			}

			function populateFieldsFromRTE() {
				var onlineEventInstr = document.getElementById(
					"online_event_instructions"
				);
				onlineEventInstr.value = quillOnlineEventInstr.root.innerHTML;

				var addlEventInfo = document.getElementById("additional_event_info");
				addlEventInfo.value = quillAddlEventInfo.root.innerHTML;
			}

			function validateEventInput() {
				let hasErrors = false;
				let errorMsg =
					"Please review and address the following errors:" + "<br>";

				let title = document.getElementById("title");
				if (title && !title.value) {
					hasErrors = true;
					errorMsg += "* " + "Title is required." + "<br>";
					let titleErrorDiv = document.getElementById("title_error");
					titleErrorDiv.innerHTML =
						'<font color="red" size="2";>' + "Title is required." + "</font>";
					titleErrorDiv.style = "display:block;";
					fieldErrorDivs.push(titleErrorDiv);
				}

				let startTime = document.getElementById("start_time");
				let startTimeTime = document.getElementById("start_time_time");
				if (
					(startTime && !startTime.value) ||
					(startTimeTime && !startTimeTime.value)
				) {
					hasErrors = true;
					errorMsg +=
						"* " +
						"Start date and time are required and must be in the future." +
						"<br>";
					let startTimeErrorDiv = document.getElementById("start_time_error");
					startTimeErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"Start date and time are required and must be in the future." +
						"</font>";
					startTimeErrorDiv.style = "display:block;";
					fieldErrorDivs.push(startTimeErrorDiv);
				}

				let endTime = document.getElementById("end_time");
				let endTimeTime = document.getElementById("end_time_time");
				if (
					(endTime && !endTime.value) ||
					(endTimeTime && !endTimeTime.value)
				) {
					hasErrors = true;
					errorMsg +=
						"* " +
						"End date and time are required and must be in the future." +
						"<br>";
					let endTimeErrorDiv = document.getElementById("end_time_error");
					endTimeErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"End date and time are required and must be in the future." +
						"</font>";
					endTimeErrorDiv.style = "display:block;";
					fieldErrorDivs.push(endTimeErrorDiv);
				}

				if (hasErrors) {
					buttonsController(false);

					return false;
				}

				return true;
			}

			function saveEventSettings() {
				clearFieldErrors();
				if (validateEventSettingsInput()) {
					buttonsController(true);
					google.script.run
						.withSuccessHandler(saveEventSettingsSuccessCallback)
						.withFailureHandler(saveEventFailureCallback)
						.uiSaveEventSettings($("#event_settings_form")[0]);
				}

				buttonsController(false);
			}

			function saveEventSettingsSuccessCallback(ecData) {
				loadFieldErrors(ecData.fieldErrors);
				buttonsController(false);

				if (ecData.statusText && ecData.statusText.length > 0) {
					showStatus(ecData.statusText);
				}

				if (!ecData.fieldErrors) {
					loadFormFieldsFromObj(ecData.event);
					populateShareEvent(ecData.event, ecData.eventWebsiteURL);
				}
			}

			function enableWaitlist() {
				let enableWlField = document.getElementById("waitlist_enabled");
				let maxWlRegs = document.getElementById(
					"waitlist_max_registrants_component"
				);
				if (enableWlField && enableWlField.checked) {
					maxWlRegs.style.display = "block";
				} else {
					maxWlRegs.style.display = "none";
				}
			}

			function publishEvent() {
				document.getElementById("review_registration_form_modal").style =
					"display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("review_registration_form_modal");
					});
			}

			function reviewRegForm() {
				window.open(regFormURL, "_blank");
				document.getElementById("continue_button_div").style.display = "block";
				document.getElementById("review_later_button_div").style.display =
					"none";
				document.getElementById("review_reg_form_button").className = "active";
			}

			function displayPublishModal() {
				closeModalLayer("review_registration_form_modal");
				document.getElementById("publish_event_modal").style = "display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("publish_event_modal");
					});
			}

			function finalPublishEvent() {
				buttonsController(true);
				google.script.run
					.withSuccessHandler(publishEventSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiPublishEvent();
			}

			function publishEventSuccessCallback(ecData) {
				buttonsController(false);

				if (ecData.statusText && ecData.statusText.length > 0) {
					closeModalLayer("publish_event_modal");
					showStatus(ecData.statusText);
				} else {
					populateEventConsoleData(ecData);
				}
			}

			function shareEvent() {
				document.getElementById("share_event_modal").style = "display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("share_event_modal");
					});
			}

			function copyToCB() {
				let shareEventInstrText =
					document.getElementById("share_event_instr").value;
				try {
					navigator.clipboard.writeText(shareEventInstrText);
				} catch (err) {}
			}

			let eventDateTimeDiff = 3600000;

			function setEventDateTimeDiff(startDateTime, endDateTime) {
				if (
					!startDateTime ||
					isNaN(startDateTime.valueOf()) ||
					!endDateTime ||
					isNaN(endDateTime.valueOf())
				) {
					eventDateTimeDiff = 3600000;
					return;
				}

				if (startDateTime.getTime() >= endDateTime.getTime()) {
					eventDateTimeDiff = 3600000;
					return;
				}

				eventDateTimeDiff = endDateTime.getTime() - startDateTime.getTime();
			}

			function clearDateFieldErrors() {
				document.getElementById("start_time_error").innerHTML = "";
				document.getElementById("start_time_error").style = "display:none;";
				document.getElementById("end_time_error").innerHTML = "";
				document.getElementById("end_time_error").style = "display:none;";
			}

			function eventStartDateOnChange(startFieldName, endFieldName, errorText) {
				clearDateFieldErrors();
				let startTimeFieldValue = document.getElementById(startFieldName).value;
				let startTimeTimeFieldValue = document.getElementById(
					startFieldName + "_time"
				).value;
				let eventStartDateTime = new Date(
					startTimeFieldValue + "T" + startTimeTimeFieldValue
				);
				let eventStartDate = new Date(startTimeFieldValue + "T00:00");

				let endTimeFieldValue = document.getElementById(endFieldName).value;
				let endTimeTimeFieldValue = document.getElementById(
					endFieldName + "_time"
				).value;
				let eventEndDateTime = new Date(
					endTimeFieldValue + "T" + endTimeTimeFieldValue
				);
				let eventEndDate = new Date(endTimeFieldValue + "T00:00");

				if (eventStartDateTime && !isNaN(eventStartDateTime.valueOf())) {
					let newEventEndDateTime = new Date(
						eventStartDateTime.getTime() + eventDateTimeDiff
					);

					let month = new String(newEventEndDateTime.getMonth() + 1);
					if (month.length === 1) {
						month = "0" + month;
					}

					let date = new String(newEventEndDateTime.getDate());
					if (date.length === 1) {
						date = "0" + date;
					}

					let hours = new String(newEventEndDateTime.getHours());
					if (hours.length === 1) {
						hours = "0" + hours;
					}

					let minutes = new String(newEventEndDateTime.getMinutes());
					if (minutes.length === 1) {
						minutes = "0" + minutes;
					}

					document.getElementById(endFieldName).value =
						newEventEndDateTime.getFullYear() + "-" + month + "-" + date;
					document.getElementById(endFieldName + "_time").value =
						hours + ":" + minutes;
				} else if (
					eventStartDate &&
					!isNaN(eventStartDate.valueOf()) &&
					(!eventEndDate || isNaN(eventEndDate.valueOf()))
				) {
					document.getElementById(endFieldName).value = startTimeFieldValue;
				} else if (
					eventStartDate &&
					!isNaN(eventStartDate.valueOf()) &&
					eventEndDate &&
					!isNaN(eventEndDate.valueOf()) &&
					eventStartDate.getTime() >= eventEndDate.getTime()
				) {
					let endTimeErrorDiv = document.getElementById(
						endFieldName + "_error"
					);
					endTimeErrorDiv.innerHTML =
						'<font color="red" size="2">' + errorText + "</font>";
					endTimeErrorDiv.style = "display:block;";
				}
			}

			function eventEndDateOnChange(startFieldName, endFieldName, errorText) {
				clearDateFieldErrors();
				let startTimeFieldValue = document.getElementById(startFieldName).value;
				let startTimeTimeFieldValue = document.getElementById(
					startFieldName + "_time"
				).value;
				let eventStartDateTime = new Date(
					startTimeFieldValue + "T" + startTimeTimeFieldValue
				);

				let endTimeFieldValue = document.getElementById(endFieldName).value;
				let endTimeTimeFieldValue = document.getElementById(
					endFieldName + "_time"
				).value;
				let eventEndDateTime = new Date(
					endTimeFieldValue + "T" + endTimeTimeFieldValue
				);

				if (
					eventStartDateTime &&
					!isNaN(eventStartDateTime.valueOf()) &&
					eventEndDateTime &&
					!isNaN(eventEndDateTime.valueOf())
				) {
					if (eventStartDateTime.getTime() >= eventEndDateTime.getTime()) {
						let endTimeErrorDiv = document.getElementById(
							endFieldName + "_error"
						);
						endTimeErrorDiv.innerHTML =
							'<font color="red" size="2">' + errorText + "</font>";
						endTimeErrorDiv.style = "display:block;";
					} else {
						setEventDateTimeDiff(eventStartDateTime, eventEndDateTime);
					}
				} else {
					setEventDateTimeDiff(null, null);
				}
			}

			function setStartDefaultTime() {
				setDefaultTime("start_time_time");

				let endTimeTime = document.getElementById("end_time_time");
				if (!endTimeTime.value) {
					endTimeTime.value = "11:00";
				}
			}

			function setDefaultTime(timeFieldID) {
				let timeField = document.getElementById(timeFieldID);

				if (!timeField.value) {
					timeField.value = "10:00";
				}
			}

			function displayLocation() {
				let locType = document.getElementById("location_type");
				let location = document.getElementById("location_component");
				let onlineEventInstr = document.getElementById(
					"online_event_instructions_component"
				);

				if (locType.value === "TBD") {
					location.style.display = "none";
					onlineEventInstr.style.display = "none";
				} else if (locType.value === "VENUE") {
					location.style.display = "block";
					onlineEventInstr.style.display = "none";
				} else if (locType.value === "ONLINE_EVENT") {
					location.style.display = "none";
					onlineEventInstr.style.display = "block";
				} else {
					location.style.display = "block";
					onlineEventInstr.style.display = "block";
				}
			}

			function loadButtonsBar(eventState) {
				if (eventState === "ACTIVE") {
					$("#ec_share_event_button").show();
					$("#ec_close_reg_button").show();
				} else {
					$("#ec_close_reg_button").hide();
				}

				if (eventState === "CLOSED") {
					$("#ec_open_reg_button").show();
					$("#ec_open_reg_button_tabs").show();
					$("#ec_share_event_button").hide();
				} else {
					$("#ec_open_reg_button").hide();
					$("#ec_open_reg_button_tabs").hide();
				}

				if (eventState === "INACTIVE") {
					$("#ec_preview_event_button").show();
					$("#ec_publish_event_button").show();
				}
			}

			function loadRegButtonsBar(event) {
				let currentDate = new Date().getTime();
				let eventStartTime = new Date(
					event.start_time + "T" + event.start_time_time
				).getTime();
				let eventEndTime = new Date(
					event.end_time + "T" + event.end_time_time
				).getTime();

				if (currentDate >= eventStartTime - 3600000) {
					document.getElementById("check_in_button_bulk").style.display =
						"block";
				}
			}

			function isPositiveInteger(value) {
				if (!value || value.length === 0) return false;

				const number = Number(value);

				return Number.isInteger(number) && number > 0;
			}

			function validateEventSettingsInput() {
				let hasErrors = false;
				let errorMsg =
					"Please review and address the following errors:" + "<br>";

				let regStartTime = document.getElementById("reg_start_time");
				let regStartTimeTime = document.getElementById("reg_start_time_time");
				if (
					regStartTime &&
					regStartTime.value &&
					(!regStartTimeTime || !regStartTimeTime.value)
				) {
					hasErrors = true;
					errorMsg += "* " + "Missing registration start time." + "<br>";
					let regStartTimeErrorDiv = document.getElementById(
						"reg_start_time_error"
					);
					regStartTimeErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"Missing registration start time." +
						"</font>";
					regStartTimeErrorDiv.style = "display:block;";
					fieldErrorDivs.push(regStartTimeErrorDiv);
				}

				let regEndTime = document.getElementById("reg_end_time");
				let regEndTimeTime = document.getElementById("reg_end_time_time");
				if (
					regEndTime &&
					regEndTime.value &&
					(!regEndTimeTime || !regEndTimeTime.value)
				) {
					hasErrors = true;
					errorMsg += "* " + "Missing registration end time." + "<br>";
					let regEndTimeErrorDiv =
						document.getElementById("reg_end_time_error");
					regEndTimeErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"Missing registration end time." +
						"</font>";
					regEndTimeErrorDiv.style = "display:block;";
					fieldErrorDivs.push(regEndTimeErrorDiv);
				}

				let maxRegistrants = document.getElementById("max_registrants");
				if (
					maxRegistrants &&
					maxRegistrants.value &&
					!isPositiveInteger(maxRegistrants.value)
				) {
					hasErrors = true;
					errorMsg +=
						"* " +
						"Invalid event capacity. Please provide a whole number greater than zero." +
						"<br>";
					let maxRegistrantsErrorDiv = document.getElementById(
						"max_registrants_error"
					);
					maxRegistrantsErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"Invalid event capacity. Please provide a whole number greater than zero." +
						"</font>";
					maxRegistrantsErrorDiv.style = "display:block;";
					fieldErrorDivs.push(maxRegistrantsErrorDiv);
				}

				let waitlistMaxRegistrants = document.getElementById(
					"waitlist_max_registrants"
				);
				if (
					waitlistMaxRegistrants &&
					waitlistMaxRegistrants.value &&
					!isPositiveInteger(waitlistMaxRegistrants.value)
				) {
					hasErrors = true;
					errorMsg +=
						"* " +
						"Invalid maximum waitlist capacity. Please provide a whole number greater than zero." +
						"<br>";
					let waitlistMaxRegistrantsErrorDiv = document.getElementById(
						"waitlist_max_registrants_error"
					);
					waitlistMaxRegistrantsErrorDiv.innerHTML =
						'<font color="red" size="2">' +
						"Invalid maximum waitlist capacity. Please provide a whole number greater than zero." +
						"</font>";
					waitlistMaxRegistrantsErrorDiv.style = "display:block;";
					fieldErrorDivs.push(waitlistMaxRegistrantsErrorDiv);
				}

				if (hasErrors) {
					showStatus(errorMsg);
					return false;
				}

				hideStatus();
				return true;
			}

			function displayCloseRegModal() {
				document.getElementById("closte_reg_modal").style = "display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("closte_reg_modal");
					});
			}

			function closeRegistration() {
				buttonsController(true);

				let eventID = document.getElementById("event_id").value;
				let eventStateMessage = document.getElementById("close_reg_msg").value;
				let eventHideWebsite =
					document.getElementById("event_hide_website").checked;

				google.script.run
					.withSuccessHandler(changeEventStatusSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiUpdateEventState(
						eventID,
						"CLOSED",
						eventStateMessage,
						eventHideWebsite
					);
			}

			function openRegistration() {
				buttonsController(true);
				let eventID = document.getElementById("event_id").value;
				google.script.run
					.withSuccessHandler(changeEventStatusSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiUpdateEventState(eventID, "ACTIVE", "", false);
			}

			function discardEvent() {
				if (
					confirm(
						"Please confirm that you would like to discard this event and all associated registration data. You will NOT be able to recover this data if you continue."
					)
				) {
					buttonsController(true);
					let eventID = document.getElementById("event_id").value;
					google.script.run
						.withSuccessHandler(changeEventStatusSuccessCallback)
						.withFailureHandler(saveEventFailureCallback)
						.uiUpdateEventState(eventID, "DISCARDED", "", false);
				}
			}

			function showError(msg) {
				$("#ec_loading").hide();
				$("#ec_tabs").hide();

				$("#ec_error_msg").html(msg);
				$("#ec_error").show(100);
			}

			function populateEventConsoleDataError(e) {
				window.clearInterval(call_timeout);

				buttonsController(false);

				console.log("populateEventConsoleDataError: " + e);

				showError(e);
			}

			function setStatusDisplayNone() {
				$("#ec_status_div").css("display", "none");
			}

			function showStatus(msg) {
				status_showing = true;
				$("#ec_status_content").html(msg);
				$("#ec_status_div").show(300);
			}

			function hideStatus() {
				status_showing = false;
				$("#ec_status_div").hide(300, setStatusDisplayNone);
			}

			function populateReprocessDataTimeout() {
				window.clearInterval(call_timeout);
				buttonsController(false);

				showError(
					'Unable to reach Google services.<br><a onclick="reinit();">Try Again</a>'
				);
			}

			function openTab(evt, tabName, tabId) {
				var i, tabcontent, tablinks;

				tabcontent = document.getElementsByClassName("tabcontent");
				for (i = 0; i < tabcontent.length; i++) {
					tabcontent[i].style.display = "none";
				}

				tablinks = document.getElementsByClassName("tablinks");
				for (i = 0; i < tablinks.length; i++) {
					tablinks[i].className = tablinks[i].className.replace(" active", "");
				}

				document.getElementById(tabName).style.display = "block";
				if (evt) {
					evt.currentTarget.className += " active";
				} else {
					document.getElementById(tabId).className += " active";
				}

				if (tabName === "overview") {
					refreshOverview();
				}

				if (tabName === "registrations") {
					applyFilter(true);
				}
			}

			function saveEventSuccessCallback(ecData) {
				loadFieldErrors(ecData.fieldErrors);
				buttonsController(false);

				if (!ecData.fieldErrors) {
					loadFormFields(ecData);

					populateEventWebsiteHTML(
						ecData.event.event_state,
						ecData.eventWebsiteHTML
					);
					activateBanner(ecData.event.event_theme, ecData.eventThemes, false);

					closeAllModalLayers();
				}
			}

			function changeEventStatusSuccessCallback(ecData) {
				loadButtonsBar(ecData.event.event_state);
				buttonsController(false);
				closeModalLayer("closte_reg_modal");

				if (ecData.statusText && ecData.statusText.length > 0) {
					showStatus(ecData.statusText);
				}
			}

			function statusUpdateOnlySuccessCallback(statusText) {
				buttonsController(false);
				if (statusText && statusText.length > 0) {
					showStatus(statusText);
				}
			}

			function updateRegistrationsSuccessCallback(ecData) {
				buttonsController(false);

				document.getElementById("select_rows_header_control").checked = false;

				loadRegistrations(
					ecData.registrations,
					ecData.registrationFilter,
					ecData.registrationSortBy
				);
				if (ecData.statusText && ecData.statusText.length > 0) {
					showStatus(ecData.statusText);
				}

				displayRowSpecificUpdateMessages(ecData.localizedRegUpdateResults);
			}

			function saveEventFailureCallback() {
				buttonsController(false);
				console.log("saveEventFailureCallback: failed callback.");
			}

			function displayRowSpecificUpdateMessages(localizedRegUpdateResults) {
				if (
					!localizedRegUpdateResults ||
					localizedRegUpdateResults.length === 0
				)
					return;

				let regTableTbody = document.getElementById(
					"registrations_table_tbody"
				);

				for (let i = 0; i < localizedRegUpdateResults.length; i++) {
					let updateResult = localizedRegUpdateResults[i];
					let regEmail = updateResult.email;
					let regMessageCol = document.getElementById(
						"reg_col_update_message" + regEmail
					);
					if (regMessageCol) {
						let message;
						if (updateResult.status == "0") {
							message =
								'<font color="green" size="2";>' +
								updateResult.locStatus +
								"</font>";
						} else {
							message =
								'<font color="red" size="2";>' +
								updateResult.locStatus +
								"</font>";
						}
						regMessageCol.innerHTML = message;
					}
				}
			}

			const regStatuses = {
				ATTENDING: "Attending",
				CHECKED_IN: "Checked In",
				DECLINED_REGISTRANT: "Declined",

				DECLINED_ADMIN: "Not Approved",
				UNPROCESSED: "Pending",
				WAITLISTED: "Waitlisted",
			};

			function loadRegistrations(registrations, filter, sortBy) {
				let regTableTbody = document.getElementById(
					"registrations_table_tbody"
				);

				regTableTbody.innerHTML = "";

				loadFilterRow(filter);
				currentRegSortBy = sortBy;
				loadSortBy(sortBy);

				if (!registrations || registrations.length === 0) return;

				for (let i = 0; i < registrations.length; i++) {
					let reg = registrations[i];
					let regEmail = reg["email"];

					let regRow = regTableTbody.insertRow(-1);
					regRow.setAttribute("name", "reg_row");
					regRow.id = "reg_row" + regEmail;

					let selectRowCell = regRow.insertCell(0);
					selectRowCell.innerHTML =
						'<input type="checkbox" id="select_row_' +
						regEmail +
						'" name="select_row_checkbox" onchange="selectRow()">';
					selectRowCell.style = "text-align: center";

					let statusCell = regRow.insertCell(1);
					statusCell.innerHTML = regStatuses[reg["regStatus"]];

					let regTimeCell = regRow.insertCell(2);
					regTimeCell.innerHTML = getRegTimeDisplayStr(reg["regTime"]);

					let emailCell = regRow.insertCell(3);
					emailCell.innerHTML = regEmail;

					let firstNameCell = regRow.insertCell(4);
					firstNameCell.innerHTML = reg["firstName"];

					let lastNameCell = regRow.insertCell(5);
					lastNameCell.innerHTML = reg["lastName"];

					let regNotes = reg["notes"];

					let escapedRegNotes = regNotes
						.replace(/[\\"']/g, "\\$&")
						.replace(/\u0000/g, "\\0");

					let selectActionRowId = "select_action_button_" + regEmail;
					let actionsHTML =
						'<div class="multi_options_button"><button onclick="displayMultipleOptions(\'' +
						selectActionRowId +
						'\')" class="multi_options_btn">Select Action</button><div id="' +
						selectActionRowId +
						'" class="multi_options_button-content"><a href="#" id="view_reg_details' +
						regEmail +
						'">View Reg. Details</a><a href="#" onclick="displayNoteLayer(\'' +
						regEmail +
						"','" +
						escapedRegNotes +
						"')\">Add Note</a>";

					if (reg["regStatus"] !== "ATTENDING") {
						actionsHTML +=
							'<a href="#" onclick="changeRegStatus(\'' +
							"ATTENDING" +
							"', '" +
							regEmail +
							"')\">Mark as Attending</a>";
					}
					if (reg["regStatus"] !== "WAITLISTED") {
						actionsHTML +=
							'<a href="#" onclick="changeRegStatus(\'' +
							"WAITLISTED" +
							"', '" +
							regEmail +
							"')\">Mark as Waitlisted</a>";
					}
					if (reg["regStatus"] !== "DECLINED_ADMIN") {
						actionsHTML +=
							'<a href="#" onclick="changeRegStatus(\'' +
							"DECLINED_ADMIN" +
							"', '" +
							regEmail +
							"')\">Mark as Not Approved</a>";
					}
					if (reg["regStatus"] !== "CHECKED_IN") {
						actionsHTML +=
							'<a href="#" onclick="changeRegStatus(\'' +
							"CHECKED_IN" +
							"', '" +
							regEmail +
							"')\">Mark as Checked In</a>";
					}

					actionsHTML += "</div></div>";

					let actionsCell = regRow.insertCell(6);
					actionsCell.innerHTML = actionsHTML;
					actionsCell.style = "text-align: center";

					let viewRegDetailsAElement = document.getElementById(
						"view_reg_details" + regEmail
					);
					viewRegDetailsAElement.addEventListener("click", function () {
						viewRegDetails(
							reg["questionResponses"],
							formQuestions,
							formQuestionIDs
						);
					});

					let regNotesRow = regTableTbody.insertRow(-1);
					regNotesRow.id = "reg_row_notes" + regEmail;
					regNotesRow.insertCell(0);
					let regNotesCell = regNotesRow.insertCell(1);
					regNotesCell.colSpan = "6";
					regNotesCell.id = "reg_col_notes" + regEmail;
					if (regNotes && regNotes.length > 0) {
						regNotesCell.innerHTML =
							'<font size="2">Notes: ' + regNotes + "</font>";
					}

					let regUpdateStatusRow = regTableTbody.insertRow(-1);
					regUpdateStatusRow.id = "reg_row_update_message" + regEmail;
					regUpdateStatusRow.insertCell(0);
					let regUpdateStatusCell = regUpdateStatusRow.insertCell(1);
					regUpdateStatusCell.colSpan = "6";
					regUpdateStatusCell.id = "reg_col_update_message" + regEmail;
				}
			}

			function getRegTimeDisplayStr(regTime) {
				let today = new Date();
				let regTimeDate = new Date(regTime);

				if (
					regTimeDate.getDate() == today.getDate() &&
					regTimeDate.getMonth() == today.getMonth() &&
					regTimeDate.getFullYear() == today.getFullYear()
				) {
					return regTimeDate.toLocaleTimeString([], { timeStyle: "short" });
				}

				return regTimeDate.toLocaleDateString([], {
					month: "short",
					day: "numeric",
				});
			}

			function loadFilterRow(filter) {
				let regTableTbody = document.getElementById(
					"registrations_table_tbody"
				);

				let filterRow = regTableTbody.insertRow(-1);
				filterRow.insertCell(0);

				let statusFilterCell = filterRow.insertCell(1);
				let statusSelectElement = document.createElement("select");
				statusSelectElement.id = "status_filter";
				let emptyStatusOption = new Option();
				emptyStatusOption.value = "";
				emptyStatusOption.text = "";
				statusSelectElement.options.add(emptyStatusOption);
				for (let statusID in regStatuses) {
					let statusOption = new Option();
					statusOption.value = statusID;
					statusOption.text = regStatuses[statusID];
					if (filter && filter.regStatus && filter.regStatus[1] === statusID) {
						statusOption.selected = true;
					}
					statusSelectElement.options.add(statusOption);
				}
				statusFilterCell.appendChild(statusSelectElement);

				filterRow.insertCell(2);

				let emailFilterCell = filterRow.insertCell(3);
				let emailFilterElement = document.createElement("input");
				emailFilterElement.id = "email_filter";
				emailFilterElement.type = "text";
				emailFilterElement.maxlength = "25";
				emailFilterElement.size = "15";
				if (filter && filter.email) {
					emailFilterElement.value = filter.email;
				}
				emailFilterCell.appendChild(emailFilterElement);

				let fNameFilterCell = filterRow.insertCell(4);
				let fNameFilterElement = document.createElement("input");
				fNameFilterElement.id = "fname_filter";
				fNameFilterElement.type = "text";
				fNameFilterElement.maxlength = "25";
				fNameFilterElement.size = "15";
				if (filter && filter.firstName) {
					fNameFilterElement.value = filter.firstName;
				}
				fNameFilterCell.appendChild(fNameFilterElement);

				let lNameFilterCell = filterRow.insertCell(5);
				let lNameFilterElement = document.createElement("input");
				lNameFilterElement.id = "lname_filter";
				lNameFilterElement.type = "text";
				lNameFilterElement.maxlength = "25";
				lNameFilterElement.size = "15";
				if (filter && filter.lastName) {
					lNameFilterElement.value = filter.lastName;
				}
				lNameFilterCell.appendChild(lNameFilterElement);

				let actionFilterCell = filterRow.insertCell(6);
				actionFilterCell.style = "text-align:center";
				let applyFilterElement = document.createElement("input");
				applyFilterElement.type = "button";
				applyFilterElement.id = "apply_filter_button";
				applyFilterElement.setAttribute("class", "active");
				applyFilterElement.value = "Apply Filter";
				applyFilterElement.addEventListener("click", function () {
					applyFilter(true);
				});
				actionFilterCell.appendChild(applyFilterElement);

				if (filter && !isEmpty(filter)) {
					let clearFilterElement = document.createElement("input");
					clearFilterElement.type = "button";
					clearFilterElement.id = "clear_filter_button";
					clearFilterElement.setAttribute("class", "active");
					clearFilterElement.value = "Clear Filter";
					clearFilterElement.addEventListener("click", function () {
						applyFilter(false);
					});
					actionFilterCell.appendChild(clearFilterElement);
				}
			}

			function applyFilter(doApply, sortBy) {
				buttonsController(true);

				let filter = {};

				if (doApply) {
					filter = getFilterObj();
				}

				if (!sortBy) {
					sortBy = currentRegSortBy;
				}

				google.script.run
					.withSuccessHandler(updateRegistrationsSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiUpdateRegistrationsFilter(filter, sortBy);
			}

			function getFilterObj() {
				let filter = {};

				let statusFilter = document.getElementById("status_filter").value;
				if (statusFilter && statusFilter.length > 0) {
					filter["regStatus"] = [1, statusFilter];
				}

				let emailFilter = document.getElementById("email_filter").value;
				if (emailFilter && emailFilter.length > 0) {
					filter["email"] = [1, emailFilter + "*"];
				}

				let fNameFilter = document.getElementById("fname_filter").value;
				if (fNameFilter && fNameFilter.length > 0) {
					filter["firstName"] = [1, fNameFilter + "*"];
				}

				let lNameFilter = document.getElementById("lname_filter").value;
				if (lNameFilter && lNameFilter.length > 0) {
					filter["lastName"] = [1, lNameFilter + "*"];
				}

				return filter;
			}

			function viewFilteredRegistrations(status) {
				let statusFilter = document.getElementById("status_filter");

				for (var i = 0; i < statusFilter.options.length; i++) {
					if (statusFilter.options[i].value === status) {
						statusFilter.options[i].selected = true;
					}
				}

				document.getElementById("email_filter").value = "";
				document.getElementById("fname_filter").value = "";
				document.getElementById("lname_filter").value = "";

				openTab(null, "registrations", "reg_tab");
				applyFilter(true);
			}

			function isEmpty(obj) {
				for (const prop in obj) {
					if (Object.hasOwn(obj, prop)) {
						return false;
					}
				}

				return true;
			}

			function viewRegDetails(responses, questions, questionIDs) {
				let viewRegDetailsTable = document.getElementById(
					"view_reg_details_table"
				);

				viewRegDetailsTable.innerHTML = "";

				for (let i = 0; i < questionIDs.length; i++) {
					let questionID = questionIDs[i];
					let questionTitle = questions[questionID];
					let response = responses[questionID];

					if (!response) {
						response = "";
					}

					let row = viewRegDetailsTable.insertRow(-1);

					let questionCell = row.insertCell(0);
					questionCell.innerHTML = questionTitle;

					let responseCell = row.insertCell(1);
					responseCell.innerHTML = response;
				}

				document.getElementById("view_reg_details_modal").style =
					"display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("view_reg_details_modal");
					});
			}

			function closeModalLayer(layerId) {
				document.getElementById(layerId).style = "display:none;";
				document.getElementById("overlay").style = "display:none;";
			}

			function closeAllModalLayers() {
				document.getElementById("overlay").style = "display:none;";
				document.getElementById("edit_modal_event_theme").style =
					"display:none;";
				document.getElementById("edit_modal_eventTitle").style =
					"display:none;";
				document.getElementById("edit_modal_eventDescription").style =
					"display:none;";
				document.getElementById("edit_modal_eventWhen").style = "display:none;";
				document.getElementById("edit_modal_eventWhere").style =
					"display:none;";
				document.getElementById("edit_modal_eventAdditionalEventInfo").style =
					"display:none;";
				document.getElementById("edit_modal_eventVideoUrl").style =
					"display:none;";
			}

			function changeRegStatus(newStatus, regEmail) {
				buttonsController(true);
				hideStatus();

				let registrations = [];

				if (regEmail && regEmail.length > 0) {
					registrations.push(regEmail);
				} else {
					let selectRowCheckboxes = document.getElementsByName(
						"select_row_checkbox"
					);

					for (let i = 0; i < selectRowCheckboxes.length; i++) {
						let selectRowCheckbox = selectRowCheckboxes[i];
						if (selectRowCheckbox.checked) {
							registrations.push(selectRowCheckbox.id.slice(11));
						}
					}

					if (registrations.length === 0) {
						showStatus("Please select one or more registration rows.");
						buttonsController(false);
						return;
					}
				}

				let filter = getFilterObj();

				google.script.run
					.withSuccessHandler(updateRegistrationsSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiUpdateRegistration(
						registrations,
						newStatus,
						null,
						filter,
						currentRegSortBy
					);
			}

			function displayNoteLayer(regEmail, regNotes) {
				hideStatus();

				let registrations = [];

				if (regEmail && regEmail.length > 0) {
					registrations.push(regEmail);
				} else {
					let selectRowCheckboxes = document.getElementsByName(
						"select_row_checkbox"
					);

					for (let i = 0; i < selectRowCheckboxes.length; i++) {
						let selectRowCheckbox = selectRowCheckboxes[i];
						if (selectRowCheckbox.checked) {
							registrations.push(selectRowCheckbox.id.slice(11));
						}
					}

					if (registrations.length === 0) {
						showStatus("Please select one or more registration rows.");
						return;
					}
				}

				let addNoteInstrElement = document.getElementById(
					"add_modal_note_instructions"
				);
				let addNoteInstrHTML;

				if (regEmail && regEmail.length > 0) {
					addNoteInstrHTML =
						"Add or modify a note for the selected registration. The note is for your internal use only and will not be visible to event attendees.";
				} else if (registrations.length === 1) {
					addNoteInstrHTML =
						"Add a note for " +
						registrations.length +
						" selected registration. Provided note will override existing note on the registration if one exists. The note is for your internal use only and will not be visible to event attendees.";
				} else {
					addNoteInstrHTML =
						"Add a note for " +
						registrations.length +
						" selected registrations. Provided note will override existing notes on those registrations if they exist. The notes are for your internal use only and will not be visible to event attendees.";
				}

				addNoteInstrElement.innerHTML = addNoteInstrHTML;

				let regNotesInput = document.getElementById("add_note_input");
				if (regNotes && regNotes.length > 0) {
					regNotesInput.value = regNotes.replace("'", "'").replace('"', '"');
				} else {
					regNotesInput.value = "";
				}

				let saveButtonElement = document.createElement("input");
				saveButtonElement.type = "button";
				saveButtonElement.setAttribute("class", "action");
				saveButtonElement.value = "Save";
				saveButtonElement.addEventListener("click", function () {
					addNote(registrations);
				});

				let saveNoteButtonDiv = document.getElementById("save_note_button");

				saveNoteButtonDiv.removeChild(saveNoteButtonDiv.firstChild);
				saveNoteButtonDiv.appendChild(saveButtonElement);

				document.getElementById("add_note_modal").style = "display:block;";
				document.getElementById("overlay").style = "display:block;";
				document
					.getElementById("overlay")
					.addEventListener("click", function () {
						closeModalLayer("add_note_modal");
					});
			}

			function addNote(registrations) {
				buttonsController(true);
				closeModalLayer("add_note_modal");
				let filter = getFilterObj();

				let regNotesInput = document.getElementById("add_note_input");
				google.script.run
					.withSuccessHandler(updateRegistrationsSuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiUpdateRegistration(
						registrations,
						null,
						regNotesInput.value,
						filter,
						currentRegSortBy
					);
			}

			function selectAllRows() {
				let selectAllCheckbox = document.getElementById(
					"select_rows_header_control"
				);
				let regRows = document.getElementsByName("reg_row");

				if (!regRows || regRows.length === 0) return;

				for (let i = 0; i < regRows.length; i++) {
					let regEmail = regRows[i].id.slice(7);
					let regRowCheckbox = document.getElementById(
						"select_row_" + regEmail
					);
					regRowCheckbox.checked = selectAllCheckbox.checked;
				}
			}

			function selectRow() {
				let selectAllCheckbox = document.getElementById(
					"select_rows_header_control"
				);
				let regRows = document.getElementsByName("reg_row");

				let checked = 0;

				for (let i = 0; i < regRows.length; i++) {
					let regEmail = regRows[i].id.slice(7);
					let regRowCheckbox = document.getElementById(
						"select_row_" + regEmail
					);
					if (regRowCheckbox.checked) {
						checked++;
					}
				}

				if (checked === regRows.length) {
					selectAllCheckbox.checked = true;
				} else {
					selectAllCheckbox.checked = false;
				}
			}

			function displayMultipleOptions(buttonId) {
				document.getElementById(buttonId).classList.toggle("show");
			}

			window.onclick = function (event) {
				if (!event.target.matches(".multi_options_btn")) {
					var dropdowns = document.getElementsByClassName(
						"multi_options_button-content"
					);
					var i;
					for (i = 0; i < dropdowns.length; i++) {
						var openDropdown = dropdowns[i];
						if (openDropdown.classList.contains("show")) {
							openDropdown.classList.remove("show");
						}
					}
				}
			};

			function loadSortBy(sortBy) {
				if (!sortBy) return;

				const descSort = "&nbsp;&nbsp;&#9660;";
				const ascSort = "&nbsp;&nbsp;&#9650;";

				let sortByCol = sortBy.sortFieldName;

				sortByColName = "reg_col_sort_" + sortByCol;
				sortElement = document.getElementById(sortByColName);

				if (sortBy.sortOrder === "desc") {
					sortElement.innerHTML = descSort;
				} else {
					sortElement.innerHTML = ascSort;
				}

				let sortColumns = document.getElementsByName("reg_col_sort");
				for (let i = 0; i < sortColumns.length; i++) {
					let sortColumn = sortColumns[i];
					if (sortColumn.id !== sortByColName) {
						sortColumn.innerHTML = "";
					}
				}
			}

			function sortRegColumn(column) {
				let sortOrder = "desc";

				if (
					currentRegSortBy &&
					currentRegSortBy.sortFieldName === column &&
					currentRegSortBy.sortOrder === "desc"
				) {
					sortOrder = "asc";
				}

				let sortBy = {
					sortFieldName: column,
					sortOrder: sortOrder,
				};

				applyFilter(true, sortBy);
			}

			function exportRegistrations() {
				buttonsController(true);
				hideStatus();

				let filter = getFilterObj();

				let selectRowCheckboxes = document.getElementsByName(
					"select_row_checkbox"
				);
				if (selectRowCheckboxes.length === 0) {
					showStatus(
						"Registrations export unsuccessful. Please adjust page filters so that at least one registration record is in view."
					);
					return;
				}

				google.script.run
					.withSuccessHandler(statusUpdateOnlySuccessCallback)
					.withFailureHandler(saveEventFailureCallback)
					.uiExportRegistrations(filter, currentRegSortBy);
			}

			function buttonsController(disableButtons) {
				if (disableButtons) {
				} else {
				}

				let buttonsAction = document.getElementsByClassName("action");
				if (buttonsAction && buttonsAction.length > 0) {
					for (let i = 0; i < buttonsAction.length; i++) {
						buttonsAction[i].disabled = disableButtons;
					}
				}

				let buttonsActive = document.getElementsByClassName("active");
				if (buttonsActive && buttonsActive.length > 0) {
					for (let i = 0; i < buttonsActive.length; i++) {
						buttonsActive[i].disabled = disableButtons;
					}
				}

				let buttonsMultiOpt =
					document.getElementsByClassName("multi_options_btn");
				if (buttonsMultiOpt && buttonsMultiOpt.length > 0) {
					for (let i = 0; i < buttonsMultiOpt.length; i++) {
						buttonsMultiOpt[i].disabled = disableButtons;
					}
				}
			}
		</script>
	</head>
	<body>
		<hr style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0" />
		<br />

		<div
			id="ec_header_text"
			style="display: none"
		></div>

		<div
			id="ec_status_div"
			style="margin-top: 8px; display: block"
		>
			<span
				style="display: block; float: right"
				;=""
				><a
					style="text-decoration: none"
					onclick="hideStatus();"
					>[X]</a
				>&nbsp;</span
			>
			<div
				id="ec_status_content"
				style="font-size: 13px"
			>
				1 registration updated successfully.
			</div>
		</div>

		<div
			id="ec_mw"
			style="vertical-align: top; font-family: Sans-Serif; font-size: 14px"
		>
			<div
				id="ec_error"
				style="display: none"
			>
				<table
					border="0"
					align="center"
				>
					<tbody>
						<tr>
							<td style="text-align: center; vertical-align: middle">
								<p>
									<b>Oops!</b>&nbsp;&nbsp;Something went wrong.<br />The error
									was: <br />
								</p>
								<div id="ec_error_msg"></div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

			<div
				id="ec_loading"
				style="width: 250px; display: none"
			>
				<div class="ec_loading_wrapper">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="77"
						height="77"
						viewBox="0 0 77 77"
						fill="none"
					>
						<path
							d="M61.178 1.05469H15.8218C7.66615 1.05469 1.05469 7.66615 1.05469 15.8218V61.178C1.05469 69.3336 7.66615 75.9451 15.8218 75.9451H61.178C69.3336 75.9451 75.9451 69.3336 75.9451 61.178V15.8218C75.9451 7.66615 69.3336 1.05469 61.178 1.05469Z"
							fill="white"
						></path>
						<path
							d="M24.2945 49.1052C22.9737 49.1052 21.8513 49.5674 20.9268 50.4917C20.0027 51.4169 19.5403 52.5391 19.5403 53.8599C19.5403 55.1809 20.0023 56.3031 20.9268 57.2283C21.8516 58.1526 22.974 58.6148 24.2945 58.6148C25.5932 58.6148 26.7099 58.1526 27.6455 57.2283C28.5807 56.3043 29.0483 55.1809 29.0483 53.8599C29.0483 52.5391 28.5808 51.4177 27.6455 50.4917C26.7098 49.5682 25.5932 49.1052 24.2945 49.1052Z"
							fill="#761B7B"
						></path>
						<path
							d="M23.2382 39.0697C23.2382 37.6171 22.7212 36.374 21.6866 35.3386C20.6522 34.3042 19.4085 33.7871 17.9559 33.7871C16.5033 33.7871 15.2598 34.3043 14.2252 35.3386C13.1909 36.3732 12.6738 37.6167 12.6738 39.0697C12.6738 40.522 13.1908 41.7649 14.2252 42.7997C15.2598 43.8345 16.5033 44.3517 17.9559 44.3517C19.4085 44.3517 20.6522 43.8345 21.6866 42.7997C22.7212 41.7656 23.2382 40.522 23.2382 39.0697Z"
							fill="#761B7B"
						></path>
						<path
							d="M53.8743 26.9214C54.5999 26.9214 55.2227 26.6623 55.7393 26.1454C56.2565 25.6279 56.5156 25.0059 56.5156 24.2798C56.5156 23.5533 56.2565 22.9318 55.7393 22.4147C55.2224 21.8972 54.5999 21.6387 53.8743 21.6387C53.1477 21.6387 52.5257 21.8977 52.0084 22.4147C51.4916 22.9319 51.2329 23.5533 51.2329 24.2798C51.2329 25.0063 51.4916 25.6279 52.0084 26.1454C52.5257 26.6628 53.1477 26.9214 53.8743 26.9214Z"
							fill="#761B7B"
						></path>
						<path
							d="M24.2949 18.4695C22.688 18.4695 21.318 19.0363 20.1845 20.1696C19.0508 21.3029 18.4844 22.673 18.4844 24.2796C18.4844 25.8867 19.0508 27.2562 20.1845 28.39C21.3184 29.5236 22.6883 30.0903 24.2949 30.0903C25.9015 30.0903 27.2716 29.5233 28.4049 28.39C29.5382 27.2562 30.105 25.8864 30.105 24.2796C30.105 22.673 29.5382 21.3029 28.4049 20.1696C27.2716 19.0363 25.9015 18.4695 24.2949 18.4695Z"
							fill="#761B7B"
						></path>
						<path
							d="M62.4576 36.8245C61.8415 36.2082 61.0932 35.9004 60.2132 35.9004C59.3323 35.9004 58.5841 36.2082 57.968 36.8245C57.3522 37.4408 57.0444 38.1893 57.0444 39.0702C57.0444 39.9501 57.3522 40.6996 57.968 41.3145C58.5844 41.9311 59.3323 42.2389 60.2132 42.2389C61.0932 42.2389 61.8419 41.9311 62.4576 41.3145C63.0741 40.6989 63.3816 39.9501 63.3816 39.0702C63.3816 38.1898 63.0746 37.4412 62.4576 36.8245Z"
							fill="#761B7B"
						></path>
						<path
							d="M53.8744 50.1621C52.8613 50.1621 51.992 50.525 51.2655 51.2515C50.5398 51.9772 50.1765 52.8469 50.1765 53.86C50.1765 54.8722 50.5398 55.742 51.2655 56.4686C51.992 57.195 52.8614 57.5575 53.8744 57.5575C54.8866 57.5575 55.7559 57.1943 56.4824 56.4686C57.2089 55.7421 57.5719 54.8727 57.5719 53.86C57.5719 52.8469 57.2089 51.9781 56.4824 51.2515C55.756 50.5248 54.8866 50.1621 53.8744 50.1621Z"
							fill="#761B7B"
						></path>
						<path
							d="M39.0843 55.9719C37.9178 55.9719 36.9218 56.3854 36.096 57.2109C35.271 58.0364 34.8582 59.0319 34.8582 60.1984C34.8582 61.365 35.2705 62.3606 36.096 63.186C36.9218 64.0115 37.9174 64.4246 39.0843 64.4246C40.2509 64.4246 41.2465 64.0115 42.072 63.186C42.8975 62.3606 43.3102 61.365 43.3102 60.1984C43.3102 59.0319 42.8975 58.0364 42.072 57.2109C41.2465 56.3854 40.2509 55.9719 39.0843 55.9719Z"
							fill="#761B7B"
						></path>
						<path
							d="M39.0845 11.6025C37.324 11.6025 35.8267 12.2185 34.5941 13.451C33.3618 14.6836 32.7456 16.1806 32.7456 17.9412C32.7456 19.7019 33.3616 21.1981 34.5941 22.4309C35.8267 23.6631 37.3236 24.2794 39.0845 24.2794C40.8457 24.2794 42.342 23.6635 43.5742 22.4309C44.8063 21.1987 45.4225 19.7019 45.4225 17.9412C45.4225 16.1807 44.8063 14.6841 43.5742 13.451C42.342 12.2188 40.8457 11.6025 39.0845 11.6025Z"
							fill="#761B7B"
						></path>
					</svg>

					<div class="ec_loading_text">Loading...</div>
				</div>
			</div>

			<form
				id="event_config_form"
				action=""
			>
				<input
					type="hidden"
					id="event_id"
					name="event_id"
					value="event_1705000199085"
				/>
				<input
					type="hidden"
					id="event_website_url"
					name="event_website_url"
					value="https://e.eventform.com?eid=4sEhy8PWlUNlfZ%7Bg%7D97qosznR%7C5y59Lt%3C"
				/>
				<input
					type="hidden"
					id="doNotRefresh"
					name="doNotRefresh"
				/>

				<div
					class="modal"
					id="edit_modal_event_theme"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_event_theme');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px">Edit Event Website Theme</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
<div>
	<label for="event_theme">Event Website Theme<font color="red">*</font></label>
</div>
<div id="ec_field_label">
	Select a webiste theme that represents your event.
</div>
					<div>
						<select
							id="event_theme"
							name="event_theme"
						>
							<option value="silverglitter">Silver Glitter</option>
							<option value="party-1">Party 1</option>
							<option value="chalkboard">Chalkboard</option>
							<option value="school-2">School 2</option>
							<option value="seminar-1">Seminar 1</option>
							<option value="school-1">School 1</option>
							<option value="cupcakes">Cupcakes</option>
							<option value="party-2">Party 2</option>
						</select>
					</div>
					<div
						id="event_theme_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_event_theme');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventTitle"
				>
					<div class="modal__header"></div>
						<span
						style="display: block; float: right"
						;=""
					>
						<a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_eventTitle');"
						>
							<svg
								xmlns="http://www.w3.org/2000/svg"
								width="28"
								height="28"
								viewBox="0 0 28 28"
								fill="none"
							>
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M9.11183 2.33325H18.8885C23.1352 2.33325 25.6668 4.86492 25.6552 9.11159V18.8883C25.6552 23.1349 23.1235 25.6666 18.8768 25.6666H9.11183C4.86516 25.6666 2.3335 23.1349 2.3335 18.8766V9.11159C2.3335 4.86492 4.86516 2.33325 9.11183 2.33325ZM18.3311 19.5683L14.0001 15.2373L9.66908 19.5683C9.33085 19.9066 8.76988 19.9066 8.43164 19.5683C8.09341 19.2301 8.09341 18.6691 8.43164 18.3309L12.7627 13.9999L8.43164 9.66883C8.09341 9.33059 8.09341 8.76962 8.43164 8.43139C8.76988 8.09316 9.33085 8.09316 9.66908 8.43139L14.0001 12.7624L18.3311 8.43139C18.6694 8.09316 19.2303 8.09316 19.5686 8.43139C19.9068 8.76962 19.9068 9.33059 19.5686 9.66883L15.2375 13.9999L19.5686 18.3309C19.9068 18.6691 19.9068 19.2301 19.5686 19.5683C19.2303 19.9066 18.6694 19.9066 18.3311 19.5683Z"
									fill="black"
								></path>
							</svg>
						</a>
					</span>
					<strong style="font-size: 20px">Edit Title</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					<div>
						<label for="title">Title<font color="red">*</font></label>
					</div>
					<div>
						<input
							type="text"
							id="title"
							name="title"
							maxlength="75"
							size="75"
						/>
					</div>
					<div
						id="title_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventTitle');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventDescription"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_eventDescription');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px">Edit Brief Description</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
					<div><label for="description">Brief Description</label></div>
					<div id="ec_field_label">
						Provide a brief but catchy description for your event.
					</div>
					<div>
						<textarea
							id="description"
							name="description"
							rows="4"
							cols="73"
							maxlength="150"
						></textarea>
					</div>
					<div
						id="description_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventDescription');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventWhen"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_eventWhen');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px">Edit Date and Time</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
					<div>
						<label for="start_time"
							>Event Date and Time<font color="red">*</font></label
						>
					</div>
					<div id="ec_field_label">
						Let people know when your event starts and ends.
					</div>
					<div>
						<input
							type="date"
							id="start_time"
							name="start_time"
							onchange="eventStartDateOnChange('start_time','end_time', 'End date and time must be later than start date and time.')"
							required=""
						/>&nbsp;<input
							id="start_time_time"
							type="time"
							name="start_time_time"
							step="60"
							onchange="eventStartDateOnChange('start_time','end_time', 'End date and time must be later than start date and time.')"
							onclick="setStartDefaultTime()"
							required=""
						/>&nbsp;&nbsp;to&nbsp;&nbsp;<input
							id="end_time_time"
							type="time"
							name="end_time_time"
							step="60"
							onchange="eventEndDateOnChange('start_time','end_time', 'End date and time must be later than start date and time.')"
							onclick="setDefaultTime('end_time_time')"
							required=""
						/>&nbsp;<input
							type="date"
							id="end_time"
							name="end_time"
							onchange="eventEndDateOnChange('start_time','end_time', 'End date and time must be later than start date and time.')"
							required=""
						/>&nbsp;<span
							id="event_date_timezone"
							name="event_date_timezone"
						></span>
					</div>
					<div
						id="start_time_error"
						style="display: none"
					></div>
					<div
						id="end_time_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventWhen');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventWhere"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_eventWhere');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px">Edit Location</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
					<div><label for="location_type">Location</label></div>
					<div id="ec_field_label">
						Tell attendees whether this event will be held online or in-person.
					</div>
					<div>
						<select
							id="location_type"
							name="location_type"
							onchange="displayLocation();"
						>
							<option
								value="TBD"
								selected=""
							>
								To Be Announced
							</option>
							<option value="VENUE">In-Person Event</option>
							<option value="ONLINE_EVENT">Online Event</option>
							<option value="HYBRID">Both In-Person and Online Event</option>
						</select>
					</div>
					<div
						id="location_type_error"
						style="display: none"
					></div>
					<div
						id="location_component"
						style="display: none"
					>
						<br />
						<div><label for="location">In-Person Location</label></div>
						<div id="ec_field_label">
							Tell attendees where to show up for the event.
						</div>
						<div>
							<input
								type="text"
								id="location"
								name="location"
								maxlength="100"
								size="75"
							/>
						</div>
						<div
							id="location_error"
							style="display: none"
						></div>
					</div>
					<div
						id="online_event_instructions_component"
						style="display: none"
					>
						<br />
						<div>
							<label for="online_event_instructions"
								>Online Event Instructions</label
							>
						</div>
						<div id="ec_field_label">
							Tell attendees how to join your event remotely.
						</div>

						<input
							id="online_event_instructions"
							name="online_event_instructions"
							type="hidden"
							value=""
						/>
						<div class="ql-toolbar ql-snow">
							<span class="ql-formats"
								><span class="ql-header ql-picker"
									><span
										class="ql-picker-label"
										tabindex="0"
										role="button"
										aria-expanded="false"
										aria-controls="ql-picker-options-0"
										><svg viewBox="0 0 18 18">
											<polygon
												class="ql-stroke"
												points="7 11 9 13 11 11 7 11"
											></polygon>
											<polygon
												class="ql-stroke"
												points="7 7 9 5 11 7 7 7"
											></polygon></svg></span
									><span
										class="ql-picker-options"
										aria-hidden="true"
										tabindex="-1"
										id="ql-picker-options-0"
										><span
											tabindex="0"
											role="button"
											class="ql-picker-item"
											data-value="1"
										></span
										><span
											tabindex="0"
											role="button"
											class="ql-picker-item"
											data-value="2"
										></span
										><span
											tabindex="0"
											role="button"
											class="ql-picker-item"
											data-value="3"
										></span
										><span
											tabindex="0"
											role="button"
											class="ql-picker-item ql-selected"
										></span></span></span
								><select
									class="ql-header"
									style="display: none"
								>
									<option value="1"></option>
									<option value="2"></option>
									<option value="3"></option>
									<option selected="selected"></option></select></span
							><span class="ql-formats"
								><button
									type="button"
									class="ql-bold"
								>
									<svg viewBox="0 0 18 18">
										<path
											class="ql-stroke"
											d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"
										></path>
										<path
											class="ql-stroke"
											d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"
										></path>
									</svg></button
								><button
									type="button"
									class="ql-italic"
								>
									<svg viewBox="0 0 18 18">
										<line
											class="ql-stroke"
											x1="7"
											x2="13"
											y1="4"
											y2="4"
										></line>
										<line
											class="ql-stroke"
											x1="5"
											x2="11"
											y1="14"
											y2="14"
										></line>
										<line
											class="ql-stroke"
											x1="8"
											x2="10"
											y1="14"
											y2="4"
										></line>
									</svg></button
								><button
									type="button"
									class="ql-underline"
								>
									<svg viewBox="0 0 18 18">
										<path
											class="ql-stroke"
											d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"
										></path>
										<rect
											class="ql-fill"
											height="1"
											rx="0.5"
											ry="0.5"
											width="12"
											x="3"
											y="15"
										></rect>
									</svg></button
								><button
									type="button"
									class="ql-link"
								>
									<svg viewBox="0 0 18 18">
										<line
											class="ql-stroke"
											x1="7"
											x2="11"
											y1="7"
											y2="11"
										></line>
										<path
											class="ql-even ql-stroke"
											d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"
										></path>
										<path
											class="ql-even ql-stroke"
											d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"
										></path>
									</svg></button></span
							><span class="ql-formats"
								><button
									type="button"
									class="ql-list"
									value="ordered"
								>
									<svg viewBox="0 0 18 18">
										<line
											class="ql-stroke"
											x1="7"
											x2="15"
											y1="4"
											y2="4"
										></line>
										<line
											class="ql-stroke"
											x1="7"
											x2="15"
											y1="9"
											y2="9"
										></line>
										<line
											class="ql-stroke"
											x1="7"
											x2="15"
											y1="14"
											y2="14"
										></line>
										<line
											class="ql-stroke ql-thin"
											x1="2.5"
											x2="4.5"
											y1="5.5"
											y2="5.5"
										></line>
										<path
											class="ql-fill"
											d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"
										></path>
										<path
											class="ql-stroke ql-thin"
											d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"
										></path>
										<path
											class="ql-stroke ql-thin"
											d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"
										></path>
									</svg></button
								><button
									type="button"
									class="ql-list"
									value="bullet"
								>
									<svg viewBox="0 0 18 18">
										<line
											class="ql-stroke"
											x1="6"
											x2="15"
											y1="4"
											y2="4"
										></line>
										<line
											class="ql-stroke"
											x1="6"
											x2="15"
											y1="9"
											y2="9"
										></line>
										<line
											class="ql-stroke"
											x1="6"
											x2="15"
											y1="14"
											y2="14"
										></line>
										<line
											class="ql-stroke"
											x1="3"
											x2="3"
											y1="4"
											y2="4"
										></line>
										<line
											class="ql-stroke"
											x1="3"
											x2="3"
											y1="9"
											y2="9"
										></line>
										<line
											class="ql-stroke"
											x1="3"
											x2="3"
											y1="14"
											y2="14"
										></line>
									</svg></button></span
							><span class="ql-formats"
								><button
									type="button"
									class="ql-clean"
								>
									<svg
										class=""
										viewBox="0 0 18 18"
									>
										<line
											class="ql-stroke"
											x1="5"
											x2="13"
											y1="3"
											y2="3"
										></line>
										<line
											class="ql-stroke"
											x1="6"
											x2="9.35"
											y1="12"
											y2="3"
										></line>
										<line
											class="ql-stroke"
											x1="11"
											x2="15"
											y1="11"
											y2="15"
										></line>
										<line
											class="ql-stroke"
											x1="15"
											x2="11"
											y1="11"
											y2="15"
										></line>
										<rect
											class="ql-fill"
											height="1"
											rx="0.5"
											ry="0.5"
											width="7"
											x="2"
											y="14"
										></rect>
									</svg></button
							></span>
						</div>
						<div
							id="online_event_instructions_container"
							class="ql-container ql-snow"
						>
							<div
								class="ql-editor ql-blank"
								data-gramm="false"
								contenteditable="true"
							>
								<p><br /></p>
							</div>
							<div
								class="ql-clipboard"
								contenteditable="true"
								tabindex="-1"
							></div>
							<div class="ql-tooltip ql-hidden">
								<a
									class="ql-preview"
									target="_blank"
									href="about:blank"
								></a
								><input
									type="text"
									data-formula="e=mc^2"
									data-link="https://quilljs.com"
									data-video="Embed URL"
								/><a class="ql-action"></a><a class="ql-remove"></a>
							</div>
						</div>
						<div
							id="online_event_instructions_error"
							style="display: none"
						></div>
					</div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventWhere');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventAdditionalEventInfo"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_additional_event_info');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px"
						>Edit Additional Event Information</strong
					>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
					<div>
						<label for="additional_event_info"
							>Additional Event Information</label
						>
					</div>
					<div id="ec_field_label">
						Tell attendees more about your event. For example, you can outline
						your event's Agenda and FAQs.
					</div>
					<input
						id="additional_event_info"
						name="additional_event_info"
						type="hidden"
						value="<p><br></p>"
					/>
					<div class="ql-toolbar ql-snow">
						<span class="ql-formats"
							><span class="ql-header ql-picker"
								><span
									class="ql-picker-label"
									tabindex="0"
									role="button"
									aria-expanded="false"
									aria-controls="ql-picker-options-1"
									><svg viewBox="0 0 18 18">
										<polygon
											class="ql-stroke"
											points="7 11 9 13 11 11 7 11"
										></polygon>
										<polygon
											class="ql-stroke"
											points="7 7 9 5 11 7 7 7"
										></polygon></svg></span
								><span
									class="ql-picker-options"
									aria-hidden="true"
									tabindex="-1"
									id="ql-picker-options-1"
									><span
										tabindex="0"
										role="button"
										class="ql-picker-item"
										data-value="1"
									></span
									><span
										tabindex="0"
										role="button"
										class="ql-picker-item"
										data-value="2"
									></span
									><span
										tabindex="0"
										role="button"
										class="ql-picker-item"
										data-value="3"
									></span
									><span
										tabindex="0"
										role="button"
										class="ql-picker-item"
									></span></span></span
							><select
								class="ql-header"
								style="display: none"
							>
								<option value="1"></option>
								<option value="2"></option>
								<option value="3"></option>
								<option selected="selected"></option></select></span
						><span class="ql-formats"
							><button
								type="button"
								class="ql-bold"
							>
								<svg viewBox="0 0 18 18">
									<path
										class="ql-stroke"
										d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"
									></path>
									<path
										class="ql-stroke"
										d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"
									></path>
								</svg></button
							><button
								type="button"
								class="ql-italic"
							>
								<svg viewBox="0 0 18 18">
									<line
										class="ql-stroke"
										x1="7"
										x2="13"
										y1="4"
										y2="4"
									></line>
									<line
										class="ql-stroke"
										x1="5"
										x2="11"
										y1="14"
										y2="14"
									></line>
									<line
										class="ql-stroke"
										x1="8"
										x2="10"
										y1="14"
										y2="4"
									></line>
								</svg></button
							><button
								type="button"
								class="ql-underline"
							>
								<svg viewBox="0 0 18 18">
									<path
										class="ql-stroke"
										d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"
									></path>
									<rect
										class="ql-fill"
										height="1"
										rx="0.5"
										ry="0.5"
										width="12"
										x="3"
										y="15"
									></rect>
								</svg></button
							><button
								type="button"
								class="ql-link"
							>
								<svg viewBox="0 0 18 18">
									<line
										class="ql-stroke"
										x1="7"
										x2="11"
										y1="7"
										y2="11"
									></line>
									<path
										class="ql-even ql-stroke"
										d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"
									></path>
									<path
										class="ql-even ql-stroke"
										d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"
									></path>
								</svg></button></span
						><span class="ql-formats"
							><button
								type="button"
								class="ql-list"
								value="ordered"
							>
								<svg viewBox="0 0 18 18">
									<line
										class="ql-stroke"
										x1="7"
										x2="15"
										y1="4"
										y2="4"
									></line>
									<line
										class="ql-stroke"
										x1="7"
										x2="15"
										y1="9"
										y2="9"
									></line>
									<line
										class="ql-stroke"
										x1="7"
										x2="15"
										y1="14"
										y2="14"
									></line>
									<line
										class="ql-stroke ql-thin"
										x1="2.5"
										x2="4.5"
										y1="5.5"
										y2="5.5"
									></line>
									<path
										class="ql-fill"
										d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"
									></path>
									<path
										class="ql-stroke ql-thin"
										d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"
									></path>
									<path
										class="ql-stroke ql-thin"
										d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"
									></path>
								</svg></button
							><button
								type="button"
								class="ql-list"
								value="bullet"
							>
								<svg viewBox="0 0 18 18">
									<line
										class="ql-stroke"
										x1="6"
										x2="15"
										y1="4"
										y2="4"
									></line>
									<line
										class="ql-stroke"
										x1="6"
										x2="15"
										y1="9"
										y2="9"
									></line>
									<line
										class="ql-stroke"
										x1="6"
										x2="15"
										y1="14"
										y2="14"
									></line>
									<line
										class="ql-stroke"
										x1="3"
										x2="3"
										y1="4"
										y2="4"
									></line>
									<line
										class="ql-stroke"
										x1="3"
										x2="3"
										y1="9"
										y2="9"
									></line>
									<line
										class="ql-stroke"
										x1="3"
										x2="3"
										y1="14"
										y2="14"
									></line>
								</svg></button></span
						><span class="ql-formats"
							><button
								type="button"
								class="ql-clean"
							>
								<svg
									class=""
									viewBox="0 0 18 18"
								>
									<line
										class="ql-stroke"
										x1="5"
										x2="13"
										y1="3"
										y2="3"
									></line>
									<line
										class="ql-stroke"
										x1="6"
										x2="9.35"
										y1="12"
										y2="3"
									></line>
									<line
										class="ql-stroke"
										x1="11"
										x2="15"
										y1="11"
										y2="15"
									></line>
									<line
										class="ql-stroke"
										x1="15"
										x2="11"
										y1="11"
										y2="15"
									></line>
									<rect
										class="ql-fill"
										height="1"
										rx="0.5"
										ry="0.5"
										width="7"
										x="2"
										y="14"
									></rect>
								</svg></button
						></span>
					</div>
					<div
						id="additional_event_info_container"
						class="ql-container ql-snow"
					>
						<div
							class="ql-editor ql-blank"
							data-gramm="false"
							contenteditable="true"
						>
							<p><br /></p>
						</div>
						<div
							class="ql-clipboard"
							contenteditable="true"
							tabindex="-1"
						></div>
						<div class="ql-tooltip ql-hidden">
							<a
								class="ql-preview"
								target="_blank"
								href="about:blank"
							></a
							><input
								type="text"
								data-formula="e=mc^2"
								data-link="https://quilljs.com"
								data-video="Embed URL"
							/><a class="ql-action"></a><a class="ql-remove"></a>
						</div>
					</div>
					<div
						id="additional_event_info_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventAdditionalEventInfo');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>

				<div
					class="modal"
					id="edit_modal_eventVideoUrl"
				>
					<div class="modal__header">
						<span
						style="display: block; float: right"
						;=""
						><a
							style="text-decoration: none"
							onclick="closeModalLayer('edit_modal_eventVideoUrl');"
							>[X]</a
						>&nbsp;</span
					>
					<strong style="font-size: 20px">Edit Video</strong>
					<br /><br />
					<hr
						style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
					/>
					<br />
					</div>
					
					<div><label for="video_url">Video</label></div>
					<div id="ec_field_label">
						Add a video from Youtube or Vimeo to help your attendees visualize
						and learn more about your event. Copy and paste the full embedded
						tag for your video as provided by YouTube or Vimeo.
					</div>
					<div>
						<textarea
							id="video_url"
							name="video_url"
							rows="6"
							cols="73"
							maxlength="500"
						></textarea>
					</div>
					<div
						id="video_url_error"
						style="display: none"
					></div>
					<br /><br />
					<div
						id="save_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="saveEvent(true);"
							value="Save"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="close_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="closeModalLayer('edit_modal_eventVideoUrl');"
							value="Cancel"
						/>&nbsp;&nbsp;
					</div>
				</div>
			</form>

			<div
				style="display: none"
				id="review_and_publish"
			>
				<div
					style="
						margin-bottom: 10px;
						border-bottom: solid 1px;
						font-weight: bold;
						min-height: 45px;
					"
				>
					Review the details and appearence of your event below. You can click
					on fields to change them.<br />
					<i
						>Click "Preview Website" to see what your website will look like on
						eventform.com.</i
					>
				</div>
				<div
					id="themed_event_view"
					style="height:360px;margin-left:5px; border solid 1px; overflow-y:scroll;"
				></div>

				<div
					id="ec_event_create_menu_bar"
					style="
						min-height: 45px;
						margin-top: 10px;
						padding-top: 10px;
						border-top: solid 1px;
					"
				>
					<span id="ec_event_create_menu_buttons">
						<div
							id="ec_publish_event_button"
							style="
								display: none;
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<input
								type="button"
								class="action"
								onclick="publishEvent();"
								value="Next"
							/>&nbsp;&nbsp;
						</div>
						<div
							id="ec_preview_event_button"
							style="
								display: none;
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<input
								type="button"
								class="active"
								onclick="previewEvent();"
								value="Preview Website [⬈]"
							/>&nbsp;&nbsp;
						</div>
					</span>
				</div>
			</div>
			<div
				class="modal"
				id="review_registration_form_modal"
				style="display: none"
			>
				<div class="modal__header">
					<span
					style="display: block; float: right"
					;=""
					><a
						style="text-decoration: none"
						onclick="closeModalLayer('review_registration_form_modal');"
						>[X]</a
					>&nbsp;</span
				>
				<strong style="font-size: 20px">Review Registration Form</strong>
				<br /><br />
				<hr
					style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
				/>
				<br />
				</div>
				
				<div>
					Before proceeding, please review the Google Form people will use to
					register. Be sure the first two questions collect their first and last
					name. When you're done, come back to this window.<br /><br /><br />
				</div>
				<div
					id="continue_button_div"
					style="
						display: none;
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="action"
						onclick="displayPublishModal();"
						value="Continue"
					/>&nbsp;&nbsp;
				</div>
				<div
					id="review_reg_form_button_div"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						id="review_reg_form_button"
						type="button"
						class="action"
						onclick="reviewRegForm();"
						value="Review Registration Form [⬈]"
					/>&nbsp;&nbsp;
				</div>
				<div
					id="review_later_button_div"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="active"
						onclick="displayPublishModal();"
						value="Review Later"
					/>&nbsp;&nbsp;
				</div>
				<div
					id="close_button"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="active"
						onclick="closeModalLayer('review_registration_form_modal');"
						value="Cancel"
					/>&nbsp;&nbsp;
				</div>
			</div>
			<div
				class="modal"
				id="publish_event_modal"
				style="display: none"
			>
				<div class="modal__header">
					<span
					style="display: block; float: right"
					;=""
					><a
						style="text-decoration: none"
						onclick="closeModalLayer('publish_event_modal');"
						>[X]</a
					>&nbsp;</span
				>
				<strong style="font-size: 20px">Create Event</strong>
				<br /><br />
				<hr
					style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
				/>
				<br />
				</div>
				
				<div>
					You're almost there! Click "Create My Event" to finish event creation
					and make your event's website available for registration. Don't worry,
					no one will see it until you share it.<br /><br /><br />
				</div>
				<div
					id="publish_button_div"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="action"
						onclick="finalPublishEvent();"
						value="Create My Event"
					/>&nbsp;&nbsp;
				</div>
				<div
					id="close_button"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="active"
						onclick="closeModalLayer('publish_event_modal');"
						value="Cancel"
					/>&nbsp;&nbsp;
				</div>
			</div>
			<div
				class="modal"
				id="share_event_modal"
				style="display: none"
			>
				<div class="modal__header">
					<span
					style="display: block; float: right"
					;=""
					><a
						style="text-decoration: none"
						onclick="closeModalLayer('share_event_modal');"
						>[X]</a
					>&nbsp;</span
				>
				<strong style="font-size: 20px">Share Event</strong>
				<br /><br />
				<hr
					style="width: 100%; text-align: left; margin-left: 0; margin: 0px 0"
				/>
				<br />
				</div>
				
				<div>
					Share the following instructions with your desired attendees.<br /><br />
				</div>
				<table>
					<tbody>
						<tr>
							<td>
								<textarea
									id="share_event_instr"
									name="share_event_instr"
									rows="4"
									cols="73"
									readonly=""
								></textarea>
							</td>
							<td style="vertical-align: top">
								&nbsp;&nbsp;
								<input
									type="button"
									class="action"
									onclick="copyToCB();"
									value="Copy"
								/>
							</td>
						</tr>
					</tbody>
				</table>
				<div
					id="done_button"
					style="
						float: right;
						position: sticky;
						right: 5px;
						bottom: 0;
						margin-top: 5px;
					"
				>
					<input
						type="button"
						class="active"
						onclick="closeModalLayer('share_event_modal');"
						value="Done"
					/>&nbsp;&nbsp;
				</div>
			</div>
			<div
				class="overlay"
				id="overlay"
				style="display: none"
			></div>
			<div
				style=""
				id="ec_tabs"
			>
				<div class="tab">
					<span
						class="tablinks"
						style="display: block"
						onclick="openTab(event, 'overview')"
						>Overview</span
					>
					<span
						id="reg_tab"
						class="tablinks active"
						onclick="openTab(event, 'registrations')"
						>Registrations</span
					>
					<span
						id="event_website_tab"
						class="tablinks"
						onclick="openTab(event, 'event_website')"
						>Event Website</span
					>
					<span
						id="settings_tab"
						class="tablinks"
						onclick="openTab(event, 'settings')"
						>Settings</span
					>
					<div
						id="ec_share_event_button"
						style="
							float: right;
							position: sticky;
							right: 0px;
							bottom: 0;
							margin-top: 2px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="shareEvent();"
							value="Share Event"
						/>&nbsp;
					</div>
					<div
						id="ec_open_reg_button_tabs"
						style="
							display: none;
							float: right;
							position: sticky;
							right: 0px;
							bottom: 0;
							margin-top: 2px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="openRegistration();"
							value="Open Registration"
						/>&nbsp;
					</div>
				</div>

				<div
					id="overview"
					class="tabcontent active"
					style="display: none"
				>
					<table
						class="overview_grid"
						width="100%"
					>
						<tbody>
							<tr>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span>Time Until Your Event:</span>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="time_till_event_overview"
														>3 Days and 22 Hours</span
													>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="time_till_event_overview_actions"> </span>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span id="registered_attendees_label"
														>Registered Attendees:</span
													>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="registered_attendees_overview">3</span>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="registered_attendees_actions">
														<a
															href="#"
															onclick="viewFilteredRegistrations('ATTENDING')"
															>View</a
														>&nbsp;&nbsp;|&nbsp;&nbsp;<a
															href="#"
															onclick="editEventCapacity()"
															>Edit Event Capacity</a
														>
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span>Event Website:</span>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="event_website_overview"></span>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="event_website_actions">
														<a
															href="#"
															onclick="previewEvent();"
															>View</a
														>&nbsp;&nbsp;|&nbsp;&nbsp;<a
															href="#"
															onclick="editEventWebsite()"
															>Edit</a
														>&nbsp;&nbsp;|&nbsp;&nbsp;<a
															href="#"
															onclick="shareEvent()"
															>Share</a
														>
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span>Time Until Registration Closes:</span>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="days_till_reg_close_overview"
														>3 Days and 22 Hours</span
													>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="days_till_reg_close_actions"
														><a
															href="#"
															onclick="editRegistrationPeriod()"
															>Edit Reg. Period</a
														></span
													>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span>Awaiting Approval:</span>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="awaiting_admin_approval_overview">0</span>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="awaiting_admin_actions"
														><a
															href="#"
															onclick="viewFilteredRegistrations('UNPROCESSED')"
															>View</a
														></span
													>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
								<td>
									<table class="overview_content_grid">
										<tbody>
											<tr>
												<td class="overview_label">
													<span>Waitlisted:</span>
												</td>
											</tr>
											<tr>
												<td class="overview_value">
													<span id="waitlisted_overview">0</span>
												</td>
											</tr>
											<tr>
												<td class="overview_actions">
													<span id="waitlisted_actions"
														><a
															href="#"
															onclick="viewFilteredRegistrations('WAITLISTED')"
															>View</a
														>&nbsp;&nbsp;|&nbsp;&nbsp;<a
															href="#"
															onclick="editWaitlistSettings()"
															>Edit Waitlist Settings</a
														></span
													>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</tbody>
					</table>
					<div
						id="last_refresh_overview"
						class="last_refresh"
					>
						Last Updated: 11:05:45 AM
					</div>
				</div>

				<div
					id="registrations"
					class="tabcontent"
					style="display: block"
				>
					<table id="registrations_table">
						<thead>
							<tr>
								<th style="text-align: center">
									<input
										type="checkbox"
										id="select_rows_header_control"
										name="select_rows_header_control"
										onchange="selectAllRows()"
									/>
								</th>
								<th>
									<a
										href="#"
										onclick="sortRegColumn('regStatus')"
										>Status<span
											id="reg_col_sort_regStatus"
											name="reg_col_sort"
										></span
									></a>
								</th>
								<th>
									<a
										href="#"
										onclick="sortRegColumn('regTime')"
										>Reg. Date<span
											id="reg_col_sort_regTime"
											name="reg_col_sort"
											>&nbsp;&nbsp;▼</span
										></a
									>
								</th>
								<th>
									<a
										href="#"
										onclick="sortRegColumn('email')"
										>Email<span
											id="reg_col_sort_email"
											name="reg_col_sort"
										></span
									></a>
								</th>
								<th>
									<a
										href="#"
										onclick="sortRegColumn('firstName')"
										>First Name<span
											id="reg_col_sort_firstName"
											name="reg_col_sort"
										></span
									></a>
								</th>
								<th>
									<a
										href="#"
										onclick="sortRegColumn('lastName')"
										>Last Name<span
											id="reg_col_sort_lastName"
											name="reg_col_sort"
										></span
									></a>
								</th>
								<th style="text-align: center">Actions</th>
							</tr>
						</thead>
						<tbody id="registrations_table_tbody">
							<tr>
								<td></td>
								<td>
									<select id="status_filter">
										<option value=""></option>
										<option value="ATTENDING">Attending</option>
										<option value="CHECKED_IN">Checked In</option>
										<option value="DECLINED_REGISTRANT">Declined</option>
										<option value="DECLINED_ADMIN">Not Approved</option>
										<option value="UNPROCESSED">Pending</option>
										<option value="WAITLISTED">Waitlisted</option>
									</select>
								</td>
								<td></td>
								<td>
									<input
										id="email_filter"
										type="text"
										size="15"
									/>
								</td>
								<td>
									<input
										id="fname_filter"
										type="text"
										size="15"
									/>
								</td>
								<td>
									<input
										id="lname_filter"
										type="text"
										size="15"
									/>
								</td>
								<td style="text-align: center">
									<input
										type="button"
										id="apply_filter_button"
										class="active"
										value="Apply Filter"
									/>
								</td>
							</tr>
							<tr
								name="reg_row"
								id="reg_rowpete.buttee@petepetepete.com"
							>
								<td style="text-align: center">
									<input
										type="checkbox"
										id="select_row_pete.buttee@petepetepete.com"
										name="select_row_checkbox"
										onchange="selectRow()"
									/>
								</td>
								<td>Waitlisted</td>
								<td>11:05 AM</td>
								<td>pete.buttee@petepetepete.com</td>
								<td>Pete</td>
								<td>Buttee</td>
								<td style="text-align: center">
									<div class="multi_options_button">
										<button
											onclick="displayMultipleOptions('select_action_button_pete.buttee@petepetepete.com')"
											class="multi_options_btn"
										>
											Select Action
										</button>
										<div
											id="select_action_button_pete.buttee@petepetepete.com"
											class="multi_options_button-content show"
										>
											<a
												href="#"
												id="view_reg_detailspete.buttee@petepetepete.com"
												>View Reg. Details</a
											><a
												href="#"
												onclick="displayNoteLayer('pete.buttee@petepetepete.com','This is a very important guest.')"
												>Add Note</a
											><a
												href="#"
												onclick="changeRegStatus('ATTENDING', 'pete.buttee@petepetepete.com')"
												>Mark as Attending</a
											><a
												href="#"
												onclick="changeRegStatus('DECLINED_ADMIN', 'pete.buttee@petepetepete.com')"
												>Mark as Not Approved</a
											><a
												href="#"
												onclick="changeRegStatus('CHECKED_IN', 'pete.buttee@petepetepete.com')"
												>Mark as Checked In</a
											>
										</div>
									</div>
								</td>
							</tr>
							<tr id="reg_row_notespete.buttee@petepetepete.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_notespete.buttee@petepetepete.com"
								>
									<font size="2">Notes: This is a very important guest.</font>
								</td>
							</tr>
							<tr id="reg_row_update_messagepete.buttee@petepetepete.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_update_messagepete.buttee@petepetepete.com"
								>
									<font
										color="green"
										size="2"
										;=""
										>Registration updated successfully.</font
									>
								</td>
							</tr>
							<tr
								name="reg_row"
								id="reg_rowbob.barker@bobbobobobo.com"
							>
								<td style="text-align: center">
									<input
										type="checkbox"
										id="select_row_bob.barker@bobbobobobo.com"
										name="select_row_checkbox"
										onchange="selectRow()"
									/>
								</td>
								<td>Attending</td>
								<td>11:04 AM</td>
								<td>bob.barker@bobbobobobo.com</td>
								<td>Bob</td>
								<td>Barker</td>
								<td style="text-align: center">
									<div class="multi_options_button">
										<button
											onclick="displayMultipleOptions('select_action_button_bob.barker@bobbobobobo.com')"
											class="multi_options_btn"
										>
											Select Action
										</button>
										<div
											id="select_action_button_bob.barker@bobbobobobo.com"
											class="multi_options_button-content"
										>
											<a
												href="#"
												id="view_reg_detailsbob.barker@bobbobobobo.com"
												>View Reg. Details</a
											><a
												href="#"
												onclick="displayNoteLayer('bob.barker@bobbobobobo.com','')"
												>Add Note</a
											><a
												href="#"
												onclick="changeRegStatus('WAITLISTED', 'bob.barker@bobbobobobo.com')"
												>Mark as Waitlisted</a
											><a
												href="#"
												onclick="changeRegStatus('DECLINED_ADMIN', 'bob.barker@bobbobobobo.com')"
												>Mark as Not Approved</a
											><a
												href="#"
												onclick="changeRegStatus('CHECKED_IN', 'bob.barker@bobbobobobo.com')"
												>Mark as Checked In</a
											>
										</div>
									</div>
								</td>
							</tr>
							<tr id="reg_row_notesbob.barker@bobbobobobo.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_notesbob.barker@bobbobobobo.com"
								></td>
							</tr>
							<tr id="reg_row_update_messagebob.barker@bobbobobobo.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_update_messagebob.barker@bobbobobobo.com"
								></td>
							</tr>
							<tr
								name="reg_row"
								id="reg_roweddies@gmail.com"
							>
								<td style="text-align: center">
									<input
										type="checkbox"
										id="select_row_eddies@gmail.com"
										name="select_row_checkbox"
										onchange="selectRow()"
									/>
								</td>
								<td>Attending</td>
								<td>11:03 AM</td>
								<td>eddies@gmail.com</td>
								<td>Eddie</td>
								<td>Sirota</td>
								<td style="text-align: center">
									<div class="multi_options_button">
										<button
											onclick="displayMultipleOptions('select_action_button_eddies@gmail.com')"
											class="multi_options_btn"
										>
											Select Action
										</button>
										<div
											id="select_action_button_eddies@gmail.com"
											class="multi_options_button-content"
										>
											<a
												href="#"
												id="view_reg_detailseddies@gmail.com"
												>View Reg. Details</a
											><a
												href="#"
												onclick="displayNoteLayer('eddies@gmail.com','')"
												>Add Note</a
											><a
												href="#"
												onclick="changeRegStatus('WAITLISTED', 'eddies@gmail.com')"
												>Mark as Waitlisted</a
											><a
												href="#"
												onclick="changeRegStatus('DECLINED_ADMIN', 'eddies@gmail.com')"
												>Mark as Not Approved</a
											><a
												href="#"
												onclick="changeRegStatus('CHECKED_IN', 'eddies@gmail.com')"
												>Mark as Checked In</a
											>
										</div>
									</div>
								</td>
							</tr>
							<tr id="reg_row_noteseddies@gmail.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_noteseddies@gmail.com"
								></td>
							</tr>
							<tr id="reg_row_update_messageeddies@gmail.com">
								<td></td>
								<td
									colspan="6"
									id="reg_col_update_messageeddies@gmail.com"
								></td>
							</tr>
						</tbody>
					</table>

					<div
						id="check_in_button_bulk"
						style="
							display: none;
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						&nbsp;&nbsp;<button
							class="action"
							onclick="changeRegStatus('CHECKED_IN')"
						>
							Check In
						</button>
					</div>

					<div
						class="multi_options_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<button
							onclick="displayMultipleOptions('change_status_bulk')"
							class="multi_options_btn"
						>
							Change Status
						</button>
						<div
							id="change_status_bulk"
							class="multi_options_button-content"
						>
							<a
								href="#"
								onclick="changeRegStatus('ATTENDING')"
								>Attending</a
							>
							<a
								href="#"
								onclick="changeRegStatus('WAITLISTED')"
								>Waitlisted</a
							>
							<a
								href="#"
								onclick="changeRegStatus('DECLINED_ADMIN')"
								>Not Approved</a
							>
							<a
								href="#"
								onclick="changeRegStatus('CHECKED_IN')"
								>Checked In</a
							>
						</div>
					</div>
					<div
						id="add_note_button_bulk"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<button
							class="active"
							onclick="displayNoteLayer();"
						>
							Add Note</button
						>&nbsp;&nbsp;
					</div>
					<div
						id="export_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<button
							class="active"
							onclick="exportRegistrations();"
						>
							Export</button
						>&nbsp;&nbsp;
					</div>
					<div
						id="ec_close_reg_button"
						style="
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0px;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="active"
							onclick="displayCloseRegModal();"
							value="Close Registration"
						/>&nbsp;&nbsp;
					</div>
					<div
						id="ec_open_reg_button"
						style="
							display: none;
							float: right;
							position: sticky;
							right: 5px;
							bottom: 0;
							margin-top: 5px;
						"
					>
						<input
							type="button"
							class="action"
							onclick="openRegistration();"
							value="Open Registration"
						/>&nbsp;&nbsp;
					</div>

					<div
						class="modal"
						id="add_note_modal"
						style="display: none"
					>
						<div class="modal__header">
							<span
							style="display: block; float: right"
							;=""
							><a
								style="text-decoration: none"
								onclick="closeModalLayer('add_note_modal');"
								>[X]</a
							>&nbsp;</span
						>
						<h3>Add a Note</h3>
						</div>
						
						<p id="add_modal_note_instructions">
							Add or modify a note for the selected registration. The note is
							for your internal use only and will not be visible to event
							attendees.
						</p>
						<textarea
							id="add_note_input"
							name="add_note_input"
							rows="5"
							cols="65"
							maxlength="500"
						></textarea>
						<div
							id="save_note_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<input
								type="button"
								class="action"
								value="Save"
							/>
						</div>
						<div
							id="cancel_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<button
								class="active"
								onclick="closeModalLayer('add_note_modal');"
							>
								Cancel</button
							>&nbsp;&nbsp;
						</div>
					</div>

					<div
						class="modal"
						id="view_reg_details_modal"
					>
						<span
							style="display: block; float: right"
							;=""
							><a
								style="text-decoration: none"
								onclick="closeModalLayer('view_reg_details_modal');"
								>[X]</a
							>&nbsp;</span
						>
						<table id="view_reg_details_table"></table>
						<div
							id="close_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<button
								class="active"
								onclick="closeModalLayer('view_reg_details_modal');"
							>
								Close
							</button>
						</div>
					</div>

					<div
						class="modal"
						id="closte_reg_modal"
					>
						<div class="modal__header">
							<span
							style="display: block; float: right"
							;=""
							><a
								style="text-decoration: none"
								onclick="closeModalLayer('closte_reg_modal');"
								>[X]</a
							>&nbsp;</span
						>
						<strong style="font-size: 20px">Close Event Registration</strong>
						<br /><br />
						<hr
							style="
								width: 100%;
								text-align: left;
								margin-left: 0;
								margin: 0px 0;
							"
						/>
						<br />
						</div>
						
						<div>
							By closing event registration you will prevent new attendees from
							registering. You may reopen registration at any point during the
							registration period.<br /><br />
						</div>
						<div>
							<label for="close_reg_msg"
								>Close Event Registration Message</label
							>
						</div>
						<div id="ec_field_label">
							Inform potential attendees why the registration is closed and when
							it might reopen.
						</div>
						<div>
							<textarea
								id="close_reg_msg"
								name="close_reg_msg"
								rows="5"
								cols="65"
								maxlength="200"
							></textarea>
						</div>
						<br />
						<div>
							<label for="event_hide_website">Disable Event Website</label>
						</div>
						<div id="ec_field_label">
							Temporarily disable event website. Visitors will be informed to
							check back later.
						</div>
						<div>
							<input
								type="checkbox"
								id="event_hide_website"
								name="event_hide_website"
							/>
						</div>
						<br />
						<div
							id="close_reg_final_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<button
								class="action"
								onclick="closeRegistration();"
							>
								Close Registration</button
							>&nbsp;&nbsp;
						</div>
						<div
							id="cancel_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<button
								class="active"
								onclick="closeModalLayer('closte_reg_modal');"
							>
								Cancel</button
							>&nbsp;&nbsp;
						</div>
					</div>

					<div
						class="overlay"
						id="overlay"
					></div>
				</div>

				<div
					id="event_website"
					class="tabcontent"
					style="overflow-y: auto; display: none"
				>
					<div
						id="ec_event_menu_bar"
						style="
							min-height: 45px;
							border-bottom: solid 1px;
							margin-bottom: 8px;
						"
					>
						<table width="100%">
							<tbody>
								<tr>
									<td style="width: 75%">
										<span
											style="
												float: left;
												position: sticky;
												margin-top: 10px;
												font-weight: bold;
											"
											>Change your event's details and appearence by clicking on
											the fields below.</span
										>
									</td>
									<td>
										<span id="ec_menu_buttons">
											<div
												id="ec_preview_event_button"
												style="
													float: right;
													position: sticky;
													right: 0px;
													bottom: 0;
													margin-top: 5px;
												"
											>
												<input
													type="button"
													class="active"
													onclick="previewEvent();"
													value="View Website [⬈]"
												/>
											</div>
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div
						id="themed_event_view_ed"
						style="height:370px;margin-left:5px; border solid 1px; overflow-y:scroll;"
					>
						<style>
							.templateContent {
							  font-family: Lato, sans-serif;
							  font-size: 22px;
							  color: #000000;
							}

							.templateHeader1 {
							  font-size: 2em;
							  line-height: 2em;
							  font-weight: bold;
							  margin-top: 20px;
							  margin-bottom: 5px;
							}

							.templateHeader2{
							  font-size: 1.5em;
							  line-height: 1.5em;
							  font-weight: bold;
							  font-weight: bold;
							  margin-top: 20px;
							  margin-bottom: 5px;
							}

							.templateHeader3{
							  font-size: 1.17em;
							  line-height: 1.17em;
							  font-weight: bold;
							  margin-top: 20px;
							  margin-bottom: 5px;
							}

							.regButton {
							  background-color: #116E8B;
							  border: none;
							  color: white;
							  padding: 10px 32px;
							  margin: 4px 2px;
							  cursor: pointer;
							  font-weight: bold;
							  font-size: 1.5em;
							  height: 60px;
							}

							.regButton:disabled {
							  background-color: #cccccc;
							  color: #666666;
							}

							<div class="editable_field" onclick="editEventField('eventConfigStyleBlock');"><span id="span_eventConfigStyleBlock">{{eventConfigStyleBlock}}</span><span class="tooltiptext">Click to edit</span></div>
						</style>

						<!-- clear our any prior CSS from parent page. needed to ensure preview in Add-on
     closely resembles actual web page.
  -->
						<!-- <div style="all:unset;"> -->
						<div class="templateContent">
							<img
								id="bannerImage"
								width="800"
								src="https://e.eventform.com/themes/chalkboard.jpg"
								class="editable_field"
							/>

							<!-- Title must be a div (vs an <h1>) in-order to be properly editable and still have correct CSS apply. -->
							<div
								id="eventTitle"
								class="templateHeader1"
							>
								<div
									class="editable_field"
									onclick="editEventField('eventTitle');"
								>
									<span id="span_eventTitle">test event</span
									><span class="tooltiptext">Click to edit</span>
								</div>
							</div>

							<div id="eventDescription">
								<div class="templateHeader2">Event Description:</div>
								<div
									class="editable_field"
									onclick="editEventField('eventDescription');"
								>
									<span id="span_eventDescription">descr</span
									><span class="tooltiptext">Click to edit</span>
								</div>
							</div>

							<div id="eventWhen">
								<div class="templateHeader2">When:</div>
								<div
									class="editable_field"
									onclick="editEventField('eventWhen');"
								>
									<span id="span_eventWhen"
										>Jan 20, 2024 from 10:00 AM to 11:00 AM (America/Los
										Angeles)</span
									><span class="tooltiptext">Click to edit</span>
								</div>
							</div>

							<div id="eventWhere">
								<div class="templateHeader2">Where:</div>
								<div
									class="editable_field"
									onclick="editEventField('eventWhere');"
								>
									<span id="span_eventWhere">To Be Announced</span
									><span class="tooltiptext">Click to edit</span>
								</div>
							</div>

							<div id="eventRegWhen">
								<div class="templateHeader2">Registration Window:</div>
								<div
									class="editable_field"
									onclick="editEventField('eventRegWhen');"
								>
									<span id="span_eventRegWhen"
										>Until Jan 20, 2024, 10:00 AM (America/Los Angeles)</span
									><span class="tooltiptext">Click to edit</span>
								</div>
							</div>

							<div id="eventAdditionalEventInfo">
								<div class="templateHeader2">Additional Information:</div>
								<div
									class="editable_field"
									onclick="editEventField('eventAdditionalEventInfo');"
								>
									<span id="span_eventAdditionalEventInfo"
										>&lt;&nbsp;Click to add additional event
										information&nbsp;&gt;</span
									><span class="tooltiptext">Click to add</span>
								</div>
							</div>

							<div
								style="margin-top: 20px"
								id="eventVideoUrl"
							>
								<div
									class="editable_field"
									onclick="editEventField('eventVideoUrl');"
								>
									<span id="span_eventVideoUrl"
										><img
											width="200"
											src="https://scooper.gleeda.net/eventform/playvideo.png" /></span
									><span class="tooltiptext">Click to add video</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div
					id="settings"
					class="tabcontent"
					style="overflow-y: auto; display: none"
				>
					<form
						id="event_settings_form"
						action=""
					>
						<div>
							<input
								type="hidden"
								id="event_id_for_settings"
								name="event_id_for_settings"
								value="event_1705000199085"
							/>
							<div><label for="reg_start_time">Registration Period</label></div>
							<div id="ec_field_label">
								Tell attendees when event registration starts and ends so they
								can reserve their spots. If you leave these fields blank,
								registration will begin as soon as the event is created and will
								end at the start of the event.
							</div>
							<div>
								<input
									type="date"
									id="reg_start_time"
									name="reg_start_time"
								/>&nbsp;<input
									id="reg_start_time_time"
									type="time"
									name="reg_start_time_time"
									step="60"
									onclick="setDefaultTime('reg_start_time_time')"
								/>&nbsp;&nbsp;to&nbsp;&nbsp;<input
									id="reg_end_time_time"
									type="time"
									name="reg_end_time_time"
									step="60"
									onclick="setDefaultTime('reg_end_time_time')"
								/>&nbsp;<input
									type="date"
									id="reg_end_time"
									name="reg_end_time"
								/>&nbsp;<span
									id="reg_date_timezone"
									name="reg_date_timezone"
								></span>
							</div>
							<div
								id="reg_start_time_error"
								style="display: none"
							></div>
							<div
								id="reg_end_time_error"
								style="display: none"
							></div>
							<br />
							<div><label for="max_registrants">Event Capacity</label></div>
							<div id="ec_field_label">
								Specify maximum number of attendees for your event so that we
								can limit how many people can register.
							</div>
							<div>
								<input
									type="number"
									id="max_registrants"
									name="max_registrants"
									maxlength="5"
									size="3"
									min="1"
									step="1"
								/>
							</div>
							<div
								id="max_registrants_error"
								style="display: none"
							></div>
							<br />
							<div>
								<label for="waitlist_enabled"
									>Enable Registration Waitlist</label
								>
							</div>
							<div id="ec_field_label">
								Decide if you want to allow some attendees to join a waitlist
								once the event is full in case some attendees cancel.
							</div>
							<div>
								<input
									type="checkbox"
									id="waitlist_enabled"
									name="waitlist_enabled"
									onclick="enableWaitlist()"
								/>
							</div>
							<div
								id="waitlist_enabled_error"
								style="display: none"
							></div>
							<br />
							<div
								id="waitlist_max_registrants_component"
								style="display: none"
							>
								<div>
									<label for="waitlist_max_registrants"
										>Maximum Waitlist Capacity</label
									>
								</div>
								<div id="ec_field_label">
									Specify maximum number of attendees we can add to the
									waitlist.
								</div>
								<div>
									<input
										type="number"
										id="waitlist_max_registrants"
										name="waitlist_max_registrants"
										maxlength="5"
										size="3"
										min="1"
										step="1"
									/>
								</div>
								<div
									id="waitlist_max_registrants_error"
									style="display: none"
								></div>
								<br />
							</div>
							<div>
								<label for="manual_admin_approval_required"
									>Manually Approve Each Attendee</label
								>
							</div>
							<div id="ec_field_label">
								Decide if you would like to manually approve each attendee based
								on their registration form before they can secure a spot at your
								event.
							</div>
							<div>
								<input
									type="checkbox"
									id="manual_admin_approval_required"
									name="manual_admin_approval_required"
								/>
							</div>
							<div
								id="manual_admin_approval_required_error"
								style="display: none"
							></div>
							<br />
							<div><label for="website_passcode">Website Passcode</label></div>
							<div id="ec_field_label">
								Decide if you want to protect your event's website with a
								passcode. You will need to share this passcode with anyone you'd
								like to attend.
							</div>
							<div>
								<input
									type="text"
									id="website_passcode"
									name="website_passcode"
									maxlength="20"
									size="20"
								/>
							</div>
							<div
								id="website_passcode_error"
								style="display: none"
							></div>
						</div>
						<div
							id="save_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<input
								type="button"
								class="action"
								onclick="saveEventSettings();"
								value="Save"
							/>
						</div>
						<div
							id="ec_discard_event_button"
							style="
								float: right;
								position: sticky;
								right: 5px;
								bottom: 0;
								margin-top: 5px;
							"
						>
							<input
								type="button"
								class="active"
								onclick="discardEvent();"
								value="Discard Event"
							/>&nbsp;&nbsp;
						</div>
					</form>
				</div>
			</div>
		</div>


























<br><br>

<input type="time" step="900" class="customTime">
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>














		<script>
			quillOnlineEventInstr = new Quill(
				"#online_event_instructions_container",
				{
					theme: "snow",
				}
			);

			quillAddlEventInfo = new Quill("#additional_event_info_container", {
				theme: "snow",
			});
		</script>
























<script>
  // Get all elements with id="ec_field_label"
  var elements = document.querySelectorAll('[id="ec_field_label"]');

  // Iterate through each element
  elements.forEach(function(element) {
    // Find the preceding div
    var precedingDiv = element.previousElementSibling;

    // Check if the preceding div contains a <label>
    if (precedingDiv && precedingDiv.querySelector('label')) {
      // Add the class "info-div" to the preceding div
      precedingDiv.classList.add('info-div');
    }
  });
</script>






	</body>
</html>
